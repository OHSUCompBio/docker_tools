<tool id="gatk4_auto_haplotypecaller" name="GATK4 AUTO HaplotypeCaller" version="@WRAPPER_VERSION@0" profile="18.01">
  <description>- Call germline SNPs and indels via local re-assembly of haplotypes</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="version_cmd"/>
  <command detect_errors="exit_code"><![CDATA[#include source=$set_sections#
#if $optional.alleles
#set datatype = $optional.alleles.datatype
#if $optional.alleles.is_of_type("vcf_bgzip")
ln -s $optional.alleles alleles.vcf.gz &&
tabix alleles.vcf.gz &&
#else
ln -s $optional.alleles alleles.vcf &&
gatk IndexFeatureFile -I alleles.vcf &&
#end if
#end if
#if $advanced.comparison
#set datatype = $advanced.comparison.datatype
#if $advanced.comparison.is_of_type("vcf_bgzip")
ln -s $advanced.comparison comparison.vcf.gz &&
tabix comparison.vcf.gz &&
#else
ln -s $advanced.comparison comparison.vcf &&
gatk IndexFeatureFile -I comparison.vcf &&
#end if
#end if
#if $optional.dbsnp
#set datatype = $optional.dbsnp.datatype
#if $optional.dbsnp.is_of_type("vcf_bgzip")
ln -s $optional.dbsnp dbsnp.vcf.gz &&
tabix dbsnp.vcf.gz &&
#else
ln -s $optional.dbsnp dbsnp.vcf &&
gatk IndexFeatureFile -I dbsnp.vcf &&
#end if
#end if
#include source=$pre_gatk_excl_ints_chth#
#include source=$bam_index_pre_chth_req#
#include source=$pre_gatk_ints_chth#
#if $optional.population_callset
#set datatype = $optional.population_callset.datatype
#if $optional.population_callset.is_of_type("vcf_bgzip")
ln -s $optional.population_callset population_callset.vcf.gz &&
tabix population_callset.vcf.gz &&
#else
ln -s $optional.population_callset population_callset.vcf &&
gatk IndexFeatureFile -I population_callset.vcf &&
#end if
#end if
@CMD_BEGIN@ HaplotypeCaller
#if $advanced.active_probability_threshold
  --active-probability-threshold $advanced.active_probability_threshold
#end if

#if $advanced.adaptive_pruning
  $advanced.adaptive_pruning
#end if

#if $advanced.adaptive_pruning_initial_error_rate
  --adaptive-pruning-initial-error-rate $advanced.adaptive_pruning_initial_error_rate
#end if

#if $common.add_output_sam_program_record
  $common.add_output_sam_program_record
#end if

#if $common.add_output_vcf_command_line
  $common.add_output_vcf_command_line
#end if

#if $advanced.all_site_pls
  $advanced.all_site_pls
#end if

#if $advanced.allele_informative_reads_overlap_margin
  --allele-informative-reads-overlap-margin $advanced.allele_informative_reads_overlap_margin
#end if

#if $optional.alleles
#if $optional.alleles.is_of_type("vcf_bgzip")
--alleles alleles.vcf.gz
#else
--alleles alleles.vcf
#end if
#end if
#if $advanced.allow_non_unique_kmers_in_ref
  $advanced.allow_non_unique_kmers_in_ref
#end if

#if $optional.annotate_with_num_discovered_alleles
  $optional.annotate_with_num_discovered_alleles
#end if

#for $num, $txt in enumerate($optional.annotation_rpt)
#if $txt.annotation
--annotation '$txt.annotation'
#end if
#end for
#for $num, $txt in enumerate($optional.annotation_group_rpt)
#if $txt.annotation_group
--annotation-group '$txt.annotation_group'
#end if
#end for
#for $num, $txt in enumerate($optional.annotations_to_exclude_rpt)
#if $txt.annotations_to_exclude
--annotations-to-exclude '$txt.annotations_to_exclude'
#end if
#end for
#if $optional.arguments_file
  --arguments_file $optional.arguments_file
#end if

#if $output_opt.assembly_region_out_sel
--assembly-region-out $assembly_region_out
#end if
#if $optional.assembly_region_padding
  --assembly-region-padding $optional.assembly_region_padding
#end if

#if $output_opt.bam_output_sel
--bam-output $bam_output
#end if
#if $advanced.bam_writer_type
  --bam-writer-type $advanced.bam_writer_type
#end if

#if $optional.base_quality_score_threshold
  --base-quality-score-threshold $optional.base_quality_score_threshold
#end if

#if $optional.cloud_index_prefetch_buffer
  --cloud-index-prefetch-buffer $optional.cloud_index_prefetch_buffer
#end if

#if $optional.cloud_prefetch_buffer
  --cloud-prefetch-buffer $optional.cloud_prefetch_buffer
#end if

#if $advanced.comparison
#if $advanced.comparison.is_of_type("vcf_bgzip")
--comparison comparison.vcf.gz
#else
--comparison comparison.vcf
#end if
#end if
#if $advanced.contamination_fraction_per_sample_file
  --contamination-fraction-per-sample-file $advanced.contamination_fraction_per_sample_file
#end if

#if $optional.contamination_fraction_to_filter
  --contamination-fraction-to-filter $optional.contamination_fraction_to_filter
#end if

#if $optional.dbsnp
#if $optional.dbsnp.is_of_type("vcf_bgzip")
--dbsnp dbsnp.vcf.gz
#else
--dbsnp dbsnp.vcf
#end if
#end if
#if $output_opt.debug_assembly_sel
--debug-assembly $debug_assembly
#end if
#if $optional.disable_bam_index_caching
  $optional.disable_bam_index_caching
#end if

#if $advanced.disable_optimizations
  $advanced.disable_optimizations
#end if

#for $num, $txt in enumerate($common.disable_read_filter_rpt)
#if $txt.disable_read_filter
--disable-read-filter '$txt.disable_read_filter'
#end if
#end for
#if $optional.disable_sequence_dictionary_validation
  $optional.disable_sequence_dictionary_validation
#end if

#if $advanced.disable_tool_default_annotations
  $advanced.disable_tool_default_annotations
#end if

#if $common.disable_tool_default_read_filters
  $common.disable_tool_default_read_filters
#end if

#if $advanced.do_not_correct_overlapping_quality
  $advanced.do_not_correct_overlapping_quality
#end if

#if $advanced.do_not_run_physical_phasing
  $advanced.do_not_run_physical_phasing
#end if

#if $advanced.dont_increase_kmer_sizes_for_cycles
  $advanced.dont_increase_kmer_sizes_for_cycles
#end if

#if $advanced.dont_use_soft_clipped_bases
  $advanced.dont_use_soft_clipped_bases
#end if

#if $advanced.emit_ref_confidence
  --emit-ref-confidence $advanced.emit_ref_confidence
#end if

#if $advanced.enable_all_annotations
  $advanced.enable_all_annotations
#end if

#include source=$gatk_excl_ints_chth#
#if $advanced.floor_blocks
  $advanced.floor_blocks
#end if

#if $advanced.force_active
  $advanced.force_active
#end if

#if $advanced.force_call_filtered_alleles
  $advanced.force_call_filtered_alleles
#end if

#for $num, $txt in enumerate($optional.founder_id_rpt)
#if $txt.founder_id
--founder-id '$txt.founder_id'
#end if
#end for
#if $common.gatk_config_file
  --gatk-config-file $common.gatk_config_file
#end if

#if $optional.gcs_max_retries
  --gcs-max-retries $optional.gcs_max_retries
#end if

#if $output_opt.graph_output_sel
--graph-output $graph_output
#end if
#if $advanced.gvcf_gq_bands
  --gvcf-gq-bands $advanced.gvcf_gq_bands
#end if

#if $optional.heterozygosity
  --heterozygosity $optional.heterozygosity
#end if

#if $optional.heterozygosity_stdev
  --heterozygosity-stdev $optional.heterozygosity_stdev
#end if

#if $optional.indel_heterozygosity
  --indel-heterozygosity $optional.indel_heterozygosity
#end if

#if $advanced.indel_size_to_eliminate_in_ref_model
  --indel-size-to-eliminate-in-ref-model $advanced.indel_size_to_eliminate_in_ref_model
#end if

#include source=$gatk_bam_input_req#
#if $optional.interval_merging_rule
  --interval-merging-rule $optional.interval_merging_rule
#end if

#if $common.interval_set_rule
  --interval-set-rule $common.interval_set_rule
#end if

#include source=$gatk_ints_chth#
#if $advanced.kmer_size
  --kmer-size $advanced.kmer_size
#end if

#if $common.lenient
  $common.lenient
#end if

#if $advanced.max_alternate_alleles
  --max-alternate-alleles $advanced.max_alternate_alleles
#end if

#if $optional.max_assembly_region_size
  --max-assembly-region-size $optional.max_assembly_region_size
#end if

#if $advanced.max_genotype_count
  --max-genotype-count $advanced.max_genotype_count
#end if

#if $advanced.max_mnp_distance
  --max-mnp-distance $advanced.max_mnp_distance
#end if

#if $advanced.max_num_haplotypes_in_population
  --max-num-haplotypes-in-population $advanced.max_num_haplotypes_in_population
#end if

#if $advanced.max_prob_propagation_distance
  --max-prob-propagation-distance $advanced.max_prob_propagation_distance
#end if

#if $optional.max_reads_per_alignment_start
  --max-reads-per-alignment-start $optional.max_reads_per_alignment_start
#end if

#if $advanced.max_unpruned_variants
  --max-unpruned-variants $advanced.max_unpruned_variants
#end if

#if $optional.min_assembly_region_size
  --min-assembly-region-size $optional.min_assembly_region_size
#end if

#if $optional.min_base_quality_score
  --min-base-quality-score $optional.min_base_quality_score
#end if

#if $advanced.min_dangling_branch_length
  --min-dangling-branch-length $advanced.min_dangling_branch_length
#end if

#if $advanced.min_pruning
  --min-pruning $advanced.min_pruning
#end if

#if $optional.native_pair_hmm_threads
  --native-pair-hmm-threads $optional.native_pair_hmm_threads
#end if

#if $optional.native_pair_hmm_use_double_precision
  $optional.native_pair_hmm_use_double_precision
#end if

#if $advanced.num_pruning_samples
  --num-pruning-samples $advanced.num_pruning_samples
#end if

#if $optional.num_reference_samples_if_no_call
  --num-reference-samples-if-no-call $optional.num_reference_samples_if_no_call
#end if

#include source=$vcf_output_opts#
#if $optional.output_mode
  --output-mode $optional.output_mode
#end if

#if $advanced.pair_hmm_gap_continuation_penalty
  --pair-hmm-gap-continuation-penalty $advanced.pair_hmm_gap_continuation_penalty
#end if

#if $advanced.pair_hmm_implementation
  --pair-hmm-implementation $advanced.pair_hmm_implementation
#end if

#if $advanced.pcr_indel_model
  --pcr-indel-model $advanced.pcr_indel_model
#end if

#if $optional.pedigree
  --pedigree $optional.pedigree
#end if

#if $advanced.phred_scaled_global_read_mismapping_rate
  --phred-scaled-global-read-mismapping-rate $advanced.phred_scaled_global_read_mismapping_rate
#end if

#if $optional.population_callset
#if $optional.population_callset.is_of_type("vcf_bgzip")
--population-callset population_callset.vcf.gz
#else
--population-callset population_callset.vcf
#end if
#end if
#if $advanced.pruning_lod_threshold
  --pruning-lod-threshold $advanced.pruning_lod_threshold
#end if

#if $common.QUIET
  --QUIET $common.QUIET
#end if

#for $num, $txt in enumerate($common.read_filter_rpt)
#if $txt.read_filter
--read-filter '$txt.read_filter'
#end if
#end for
#if $common.read_validation_stringency
  --read-validation-stringency $common.read_validation_stringency
#end if

#if $advanced.recover_all_dangling_branches
  $advanced.recover_all_dangling_branches
#end if

#if $deprecated.recover_dangling_heads
  $deprecated.recover_dangling_heads
#end if

#include source=$ref_opts#
#if $optional.sample_name
  --sample-name $optional.sample_name
#end if

#if $optional.sample_ploidy
  --sample-ploidy $optional.sample_ploidy
#end if

#if $common.seconds_between_progress_updates
  --seconds-between-progress-updates $common.seconds_between_progress_updates
#end if

#include source=$gatk_seqdict#
#if $optional.sites_only_vcf_output
  $optional.sites_only_vcf_output
#end if

#if $advanced.smith_waterman
  --smith-waterman $advanced.smith_waterman
#end if

#if $optional.standard_min_confidence_threshold_for_calling
  --standard-min-confidence-threshold-for-calling $optional.standard_min_confidence_threshold_for_calling
#end if

#if $common.tmp_dir
  --tmp-dir $common.tmp_dir
#end if

#if $advanced.use_filtered_reads_for_annotations
  $advanced.use_filtered_reads_for_annotations
#end if

#if $common.use_jdk_deflater
  $common.use_jdk_deflater
#end if

#if $common.use_jdk_inflater
  $common.use_jdk_inflater
#end if

#if $common.verbosity
  --verbosity $common.verbosity
#end if
]]></command>
  <inputs>
    <expand macro="ref_sel"/>
    <expand macro="gzip_vcf_params"/>
    <expand macro="gatk_bam_req_params"/>
    <section name="optional" title="Optional Parameters" expanded="False">
      <expand macro="gatk_ints"/>
      <param name="alleles" argument="--alleles" type="data" optional="true" format="vcf,vcf_bgzip" label="Alleles" help="The set of alleles to force-call regardless of evidence. "/>
      <param name="annotate_with_num_discovered_alleles" argument="--annotate-with-num-discovered-alleles" type="boolean" truevalue="--annotate-with-num-discovered-alleles" falsevalue="" optional="true" checked="false" label="Annotate With Num Discovered Alleles" help="If provided, we will annotate records with the number of alternate alleles that were discovered (but not necessarily genotyped) at a given site. Depending on the value of the --max_alternate_alleles argument, we may genotype only a fraction of the alleles being sent on for genotyping.&#10; Using this argument instructs the genotyper to annotate (in the INFO field) the number of alternate alleles that were originally discovered at the site."/>
      <repeat name="annotation_rpt" default="1" title="Annotation">
        <param name="annotation" argument="--annotation" type="text" optional="true" value="" label="Annotation" help="One or more specific annotations to add to variant calls. Which annotations to include in variant calls in the output. These supplement annotations provided by annotation groups."/>
      </repeat>
      <repeat name="annotation_group_rpt" default="1" title="Annotation Group">
        <param name="annotation_group" argument="--annotation-group" type="text" optional="true" value="" label="Annotation Group" help="One or more groups of annotations to apply to variant calls. Which groups of annotations to add to the output variant calls.&#10; Any requirements that are not met (e.g. failing to provide a pedigree file for a pedigree-based annotation) may cause the run to fail."/>
      </repeat>
      <repeat name="annotations_to_exclude_rpt" default="1" title="Annotations To Exclude">
        <param name="annotations_to_exclude" argument="--annotations-to-exclude" type="text" optional="true" value="" label="Annotations To Exclude" help="One or more specific annotations to exclude from variant calls. Which annotations to exclude from output in the variant calls.  Note that this argument has higher priority than the&#10; -A or -G arguments, so these annotations will be excluded even if they are explicitly included with the other&#10; options."/>
      </repeat>
      <param name="arguments_file" argument="--arguments_file" type="data" optional="true" format="txt" label="Arguments_File" help="read one or more arguments files and add them to the command line. "/>
      <param name="assembly_region_padding" argument="--assembly-region-padding" type="integer" optional="true" value="100" label="Assembly Region Padding" help="Number of additional bases of context to include around each assembly region. Parameters that control assembly regions"/>
      <param name="base_quality_score_threshold" argument="--base-quality-score-threshold" type="integer" optional="true" value="18" label="Base Quality Score Threshold" help="Base qualities below this threshold will be reduced to the minimum (6). Bases with a quality below this threshold will reduced to the minimum usable qualiy score (6)."/>
      <param name="cloud_index_prefetch_buffer" argument="--cloud-index-prefetch-buffer" type="integer" optional="true" value="-1" label="Cloud Index Prefetch Buffer" help="Size of the cloud-only prefetch buffer (in MB; 0 to disable). Defaults to cloudPrefetchBuffer if unset. "/>
      <param name="cloud_prefetch_buffer" argument="--cloud-prefetch-buffer" type="integer" optional="true" value="40" label="Cloud Prefetch Buffer" help="Size of the cloud-only prefetch buffer (in MB; 0 to disable). "/>
      <param name="contamination_fraction_to_filter" argument="--contamination-fraction-to-filter" type="float" optional="true" value="0.0" label="Contamination Fraction To Filter" help="Fraction of contamination in sequencing data (for all samples) to aggressively remove. If this fraction is greater is than zero, the caller will aggressively attempt to remove contamination through biased down-sampling of reads.&#10; Basically, it will ignore the contamination fraction of reads for each alternate allele.  So if the pileup contains N total bases, then we&#10; will try to remove (N * contamination fraction) bases for each alternate allele."/>
      <param name="dbsnp" argument="--dbsnp" type="data" optional="true" format="vcf,vcf_bgzip" label="Dbsnp" help="dbSNP file. A dbSNP VCF file."/>
      <param name="disable_bam_index_caching" argument="--disable-bam-index-caching" type="boolean" truevalue="--disable-bam-index-caching" falsevalue="" optional="true" checked="false" label="Disable Bam Index Caching" help="If true, don&amp;apos;t cache bam indexes, this will reduce memory requirements but may harm performance if many intervals are specified.  Caching is automatically disabled if there are no intervals specified. "/>
      <param name="disable_sequence_dictionary_validation" argument="--disable-sequence-dictionary-validation" type="boolean" truevalue="--disable-sequence-dictionary-validation" falsevalue="" optional="true" checked="false" label="Disable Sequence Dictionary Validation" help="If specified, do not check the sequence dictionaries from our inputs for compatibility. Use at your own risk!. "/>
      <repeat name="founder_id_rpt" default="1" title="Founder Id">
        <param name="founder_id" argument="--founder-id" type="text" optional="true" value="" label="Founder Id" help="Samples representing the population &amp;quot;founders&amp;quot;. "/>
      </repeat>
      <param name="gcs_max_retries" argument="--gcs-max-retries" type="integer" optional="true" value="20" label="Gcs Max Retries" help="If the GCS bucket channel errors out, how many times it will attempt to re-initiate the connection. "/>
      <param name="heterozygosity" argument="--heterozygosity" type="float" optional="true" value="0.001" label="Heterozygosity" help="Heterozygosity value used to compute prior likelihoods for any locus.  See the GATKDocs for full details on the meaning of this population genetics concept. The expected heterozygosity value used to compute prior probability that a locus is non-reference.&#10;&#10; The default priors are for provided for humans:&#10;&#10; het = 1e-3&#10;&#10; which means that the probability of N samples being hom-ref at a site is:&#10;&#10; 1 - sum_i_2N (het / i)&#10;&#10; Note that heterozygosity as used here is the population genetics concept:&#10;&#10; http://en.wikipedia.org/wiki/Zygosity#Heterozygosity_in_population_genetics&#10;&#10; That is, a hets value of 0.01 implies that two randomly chosen chromosomes from the population of organisms&#10; would differ from each other (one being A and the other B) at a rate of 1 in 100 bp.&#10;&#10; Note that this quantity has nothing to do with the likelihood of any given sample having a heterozygous genotype,&#10; which in the GATK is purely determined by the probability of the observed data P(D | AB) under the model that there&#10; may be a AB het genotype.  The posterior probability of this AB genotype would use the het prior, but the GATK&#10; only uses this posterior probability in determining the prob. that a site is polymorphic.  So changing the&#10; het parameters only increases the chance that a site will be called non-reference across all samples, but&#10; doesn&amp;apos;t actually change the output genotype likelihoods at all, as these aren&amp;apos;t posterior probabilities at all.&#10;&#10; The quantity that changes whether the GATK considers the possibility of a het genotype at all is the ploidy,&#10; which determines how many chromosomes each individual in the species carries."/>
      <param name="heterozygosity_stdev" argument="--heterozygosity-stdev" type="float" optional="true" value="0.01" label="Heterozygosity Stdev" help="Standard deviation of heterozygosity for SNP and indel calling. The standard deviation of the distribution of alt allele fractions.  The above heterozygosity parameters give the&#10; *mean* of this distribution; this parameter gives its spread."/>
      <param name="indel_heterozygosity" argument="--indel-heterozygosity" type="float" optional="true" value="0.000125" label="Indel Heterozygosity" help="Heterozygosity for indel calling.  See the GATKDocs for heterozygosity for full details on the meaning of this population genetics concept. This argument informs the prior probability of having an indel at a site."/>
      <param name="interval_merging_rule" argument="--interval-merging-rule" type="select" optional="true" label="Interval Merging Rule" help="Interval merging rule for abutting intervals. By default, the program merges abutting intervals (i.e. intervals that are directly side-by-side but do not&#10; actually overlap) into a single continuous interval. However you can change this behavior if you want them to be&#10; treated as separate intervals instead.">
        <option selected="true" value="ALL">ALL</option>
        <option value="OVERLAPPING_ONLY">OVERLAPPING_ONLY</option>
      </param>
      <param name="max_assembly_region_size" argument="--max-assembly-region-size" type="integer" optional="true" value="300" label="Max Assembly Region Size" help="Maximum size of an assembly region. "/>
      <param name="max_reads_per_alignment_start" argument="--max-reads-per-alignment-start" type="integer" optional="true" value="50" label="Max Reads Per Alignment Start" help="Maximum number of reads to retain per alignment start position. Reads above this threshold will be downsampled. Set to 0 to disable. Other parameters"/>
      <param name="min_assembly_region_size" argument="--min-assembly-region-size" type="integer" optional="true" value="50" label="Min Assembly Region Size" help="Minimum size of an assembly region. Parameters that control active regions"/>
      <param name="min_base_quality_score" argument="--min-base-quality-score" type="integer" optional="true" value="10" label="Min Base Quality Score" help="Minimum base quality required to consider a base for calling. Bases with a quality below this threshold will not be used for calling."/>
      <param name="native_pair_hmm_threads" argument="--native-pair-hmm-threads" type="integer" optional="true" value="4" label="Native Pair Hmm Threads" help="How many threads should a native pairHMM implementation use. "/>
      <param name="native_pair_hmm_use_double_precision" argument="--native-pair-hmm-use-double-precision" type="boolean" truevalue="--native-pair-hmm-use-double-precision" falsevalue="" optional="true" checked="false" label="Native Pair Hmm Use Double Precision" help="use double precision in the native pairHmm. This is slower but matches the java implementation better. "/>
      <param name="num_reference_samples_if_no_call" argument="--num-reference-samples-if-no-call" type="integer" optional="true" value="0" label="Num Reference Samples If No Call" help="Number of hom-ref genotypes to infer at sites not present in a panel. When a variant is not seen in any panel, this argument controls whether to infer (and with what effective strength)&#10; that only reference alleles were observed at that site. E.g. &amp;quot;If not seen in 1000Genomes, treat it as AC=0,&#10; AN=2000&amp;quot;."/>
      <param name="output_mode" argument="--output-mode" type="select" optional="true" label="Output Mode" help="Specifies which type of calls we should output. ">
        <option selected="true" value="EMIT_VARIANTS_ONLY">EMIT_VARIANTS_ONLY</option>
        <option value="EMIT_ALL_CONFIDENT_SITES">EMIT_ALL_CONFIDENT_SITES</option>
        <option value="EMIT_ALL_ACTIVE_SITES">EMIT_ALL_ACTIVE_SITES</option>
      </param>
      <param name="pedigree" argument="--pedigree" type="data" optional="true" format="tabular" label="Pedigree" help="Pedigree file for determining the population &amp;quot;founders&amp;quot;. "/>
      <param name="population_callset" argument="--population-callset" type="data" optional="true" format="vcf,vcf_bgzip" label="Population Callset" help="Callset to use in calculating genotype priors. Supporting external panel. Allele counts from this panel (taken from AC,AN or MLEAC,AN or raw genotypes) will&#10; be used to inform the frequency distribution underlying the genotype priors. These files must be VCF 4.2 spec or later.&#10; Note that unlike CalculateGenotypePosteriors, HaplotypeCaller only allows one supporting callset."/>
      <param name="sample_name" argument="--sample-name" type="text" optional="true" value="" label="Sample Name" help="Name of single sample to use from a multi-sample bam. You can use this argument to specify that HC should process a single sample out of a multisample BAM file. This&#10; is especially useful if your samples are all in the same file but you need to run them individually through HC&#10; in -ERC GVC mode (which is the recommended usage). Note that the name is case-sensitive."/>
      <param name="sample_ploidy" argument="--sample-ploidy" type="integer" optional="true" value="2" label="Sample Ploidy" help="Ploidy (number of chromosomes) per sample. For pooled data, set to (Number of samples in each pool * Sample Ploidy). Sample ploidy - equivalent to number of chromosomes per pool. In pooled experiments this should be = # of samples in pool * individual sample ploidy"/>
      <param name="sites_only_vcf_output" argument="--sites-only-vcf-output" type="boolean" truevalue="--sites-only-vcf-output" falsevalue="" optional="true" checked="false" label="Sites Only Vcf Output" help="If true, don&amp;apos;t emit genotype fields when writing vcf file output. "/>
      <param name="standard_min_confidence_threshold_for_calling" argument="--standard-min-confidence-threshold-for-calling" type="float" optional="true" value="30.0" label="Standard Min Confidence Threshold For Calling" help="The minimum phred-scaled confidence threshold at which variants should be called. The minimum phred-scaled confidence threshold at which variants should be called. Only variant sites with QUAL equal&#10; or greater than this threshold will be called. Note that since version 3.7, we no longer differentiate high confidence&#10; from low confidence calls at the calling step. The default call confidence threshold is set low intentionally to achieve&#10; high sensitivity, which will allow false positive calls as a side effect. Be sure to perform some kind of filtering after&#10; calling to reduce the amount of false positives in your final callset. Note that when HaplotypeCaller is used in GVCF mode&#10; (using either -ERC GVCF or -ERC BP_RESOLUTION) the call threshold is automatically set to zero. Call confidence thresholding&#10; will then be performed in the subsequent GenotypeGVCFs command.&#10;&#10; Note that the default was changed from 10.0 to 30.0 in version 4.1.0.0 to accompany the switch to use the the new quality score by default."/>
    </section>
    <section name="advanced" title="Advanced Parameters" expanded="False">
      <param name="active_probability_threshold" argument="--active-probability-threshold" type="float" optional="true" value="0.002" label="Active Probability Threshold" help="Minimum probability for a locus to be considered active. "/>
      <param name="adaptive_pruning" argument="--adaptive-pruning" type="boolean" truevalue="--adaptive-pruning" falsevalue="" optional="true" checked="false" label="Adaptive Pruning" help="Use Mutect2&amp;apos;s adaptive graph pruning algorithm. A single edge multiplicity cutoff for pruning doesn&amp;apos;t work in samples with variable depths, for example exomes&#10; and RNA.  This parameter enables the probabilistic algorithm for pruning the assembly graph that considers the&#10; likelihood that each chain in the graph comes from real variation."/>
      <param name="adaptive_pruning_initial_error_rate" argument="--adaptive-pruning-initial-error-rate" type="float" optional="true" value="0.001" label="Adaptive Pruning Initial Error Rate" help="Initial base error rate estimate for adaptive pruning. Initial base error rate guess for the probabilistic adaptive pruning model.  Results are not very sensitive to this&#10; parameter because it is only a starting point from which the algorithm discovers the true error rate."/>
      <param name="all_site_pls" argument="--all-site-pls" type="boolean" truevalue="--all-site-pls" falsevalue="" optional="true" checked="false" label="All Site Pls" help="Annotate all sites with PLs. Advanced, experimental argument: if SNP likelihood model is specified, and if EMIT_ALL_ACTIVE_SITES output mode is set, when we set this argument then we will also emit PLs at all sites.&#10; This will give a measure of reference confidence and a measure of which alt alleles are more plausible (if any).&#10; WARNINGS:&#10; - This feature will inflate VCF file size considerably.&#10; - All SNP ALT alleles will be emitted with corresponding 10 PL values.&#10; - An error will be emitted if EMIT_ALL_ACTIVE_SITES is not set, or if anything other than diploid SNP model is used"/>
      <param name="allele_informative_reads_overlap_margin" argument="--allele-informative-reads-overlap-margin" type="integer" optional="true" value="2" label="Allele Informative Reads Overlap Margin" help="Likelihood and read-based annotations will only take into consideration reads that overlap the variant or any base no further than this distance expressed in base pairs. "/>
      <param name="allow_non_unique_kmers_in_ref" argument="--allow-non-unique-kmers-in-ref" type="boolean" truevalue="--allow-non-unique-kmers-in-ref" falsevalue="" optional="true" checked="false" label="Allow Non Unique Kmers In Ref" help="Allow graphs that have non-unique kmers in the reference. By default, the program does not allow processing of reference sections that contain non-unique kmers. Disabling&#10; this check may cause problems in the assembly graph."/>
      <param name="bam_writer_type" argument="--bam-writer-type" type="select" optional="true" label="Bam Writer Type" help="Which haplotypes should be written to the BAM. The type of BAM output we want to see. This determines whether HC will write out all of the haplotypes it&#10; considered (top 128 max) or just the ones that were selected as alleles and assigned to samples.">
        <option value="ALL_POSSIBLE_HAPLOTYPES">ALL_POSSIBLE_HAPLOTYPES</option>
        <option selected="true" value="CALLED_HAPLOTYPES">CALLED_HAPLOTYPES</option>
      </param>
      <param name="comparison" argument="--comparison" type="data" optional="true" format="vcf,vcf_bgzip" label="Comparison" help="Comparison VCF file(s). If a call overlaps with a record from the provided comp track, the INFO field will be annotated&#10; as such in the output with the track name (e.g. -comp:FOO will have &amp;apos;FOO&amp;apos; in the INFO field). Records that are&#10; filtered in the comp track will be ignored. Note that &amp;apos;dbSNP&amp;apos; has been special-cased (see the --dbsnp argument)."/>
      <param name="contamination_fraction_per_sample_file" argument="--contamination-fraction-per-sample-file" type="data" optional="true" format="tabular" label="Contamination Fraction Per Sample File" help="Tab-separated File containing fraction of contamination in sequencing data (per sample) to aggressively remove. Format should be &amp;quot;&amp;lt;SampleID&amp;gt;&amp;lt;TAB&amp;gt;&amp;lt;Contamination&amp;gt;&amp;quot; (Contamination is double) per line; No header. This argument specifies a file with two columns &amp;quot;sample&amp;quot; and &amp;quot;contamination&amp;quot; specifying the contamination level for those samples.&#10;  Samples that do not appear in this file will be processed with CONTAMINATION_FRACTION."/>
      <param name="disable_optimizations" argument="--disable-optimizations" type="boolean" truevalue="--disable-optimizations" falsevalue="" optional="true" checked="false" label="Disable Optimizations" help="Don&amp;apos;t skip calculations in ActiveRegions with no variants. If set, certain &amp;quot;early exit&amp;quot; optimizations in HaplotypeCaller, which aim to save compute and time by skipping&#10; calculations if an ActiveRegion is determined to contain no variants, will be disabled. This is most likely to be useful if&#10; you&amp;apos;re using the -bamout argument to examine the placement of reads following reassembly and are interested in seeing the mapping of&#10; reads in regions with no variations. Setting the --force-active flag may also be necessary."/>
      <param name="disable_tool_default_annotations" argument="--disable-tool-default-annotations" type="boolean" truevalue="--disable-tool-default-annotations" falsevalue="" optional="true" checked="false" label="Disable Tool Default Annotations" help="Disable all tool default annotations. Hook allowing for the user to remove default annotations from the tool"/>
      <param name="do_not_correct_overlapping_quality" argument="--do-not-correct-overlapping-quality" type="boolean" truevalue="--do-not-correct-overlapping-quality" falsevalue="" optional="true" checked="false" label="Do Not Correct Overlapping Quality" help="Disable overlapping base quality correction. Base quality is capped at half of PCR error rate for bases where read and mate overlap, to account for full correlation of PCR errors at these bases.  This argument disables that correction."/>
      <param name="do_not_run_physical_phasing" argument="--do-not-run-physical-phasing" type="boolean" truevalue="--do-not-run-physical-phasing" falsevalue="" optional="true" checked="false" label="Do Not Run Physical Phasing" help="Disable physical phasing. As of GATK 3.3, HaplotypeCaller outputs physical (read-based) information (see version 3.3 release notes and documentation for details). This argument disables that behavior."/>
      <param name="dont_increase_kmer_sizes_for_cycles" argument="--dont-increase-kmer-sizes-for-cycles" type="boolean" truevalue="--dont-increase-kmer-sizes-for-cycles" falsevalue="" optional="true" checked="false" label="Dont Increase Kmer Sizes For Cycles" help="Disable iterating over kmer sizes when graph cycles are detected. When graph cycles are detected, the normal behavior is to increase kmer sizes iteratively until the cycles are&#10; resolved. Disabling this behavior may cause the program to give up on assembling the ActiveRegion."/>
      <param name="dont_use_soft_clipped_bases" argument="--dont-use-soft-clipped-bases" type="boolean" truevalue="--dont-use-soft-clipped-bases" falsevalue="" optional="true" checked="false" label="Dont Use Soft Clipped Bases" help="Do not analyze soft clipped bases in the reads. "/>
      <param name="emit_ref_confidence" argument="--emit-ref-confidence" type="select" optional="true" label="Emit Ref Confidence" help="Mode for emitting reference confidence scores (For Mutect2, this is a BETA feature). The reference confidence mode makes it possible to emit a per-bp or summarized confidence estimate for a site being strictly homozygous-reference.&#10; See https://software.broadinstitute.org/gatk/documentation/article.php?id=4017 for information about GVCFs.&#10; For Mutect2, this is a BETA feature that functions similarly to the HaplotypeCaller reference confidence/GVCF mode.">
        <option selected="true" value="NONE">NONE</option>
        <option value="BP_RESOLUTION">BP_RESOLUTION</option>
        <option value="GVCF">GVCF</option>
      </param>
      <param name="enable_all_annotations" argument="--enable-all-annotations" type="boolean" truevalue="--enable-all-annotations" falsevalue="" optional="true" checked="false" label="Enable All Annotations" help="Use all possible annotations (not for the faint of heart). You can use the -AX argument in combination with this one to exclude specific annotations. Note that some&#10; annotations may not be actually applied if they are not applicable to the data provided or if they are&#10; unavailable to the tool (e.g. there are several annotations that are currently not hooked up to&#10; HaplotypeCaller). At present no error or warning message will be provided, the annotation will simply be&#10; skipped silently. You can check the output VCF header to see which annotations were activated and thus might be applied (although&#10; this does not guarantee that the annotation was applied to all records in the VCF, since some annotations have&#10; additional requirements, e.g. minimum number of samples or heterozygous sites only -- see the documentation&#10; for individual annotations&amp;apos; requirements)."/>
      <param name="floor_blocks" argument="--floor-blocks" type="boolean" truevalue="--floor-blocks" falsevalue="" optional="true" checked="false" label="Floor Blocks" help="Output the band lower bound for each GQ block regardless of the data it represents. Output the band lower bound for each GQ block instead of the min GQ -- for better compression"/>
      <param name="force_active" argument="--force-active" type="boolean" truevalue="--force-active" falsevalue="" optional="true" checked="false" label="Force Active" help="If provided, all regions will be marked as active. "/>
      <param name="force_call_filtered_alleles" argument="--force-call-filtered-alleles" type="boolean" truevalue="--force-call-filtered-alleles" falsevalue="" optional="true" checked="false" label="Force Call Filtered Alleles" help="Force-call filtered alleles included in the resource specified by --alleles. "/>
      <param name="gvcf_gq_bands" argument="--gvcf-gq-bands" type="integer" optional="true" value="" label="Gvcf Gq Bands" help="Exclusive upper bounds for reference confidence GQ bands (must be in [1, 100] and specified in increasing order). When HC is run in reference confidence mode with banding compression enabled (-ERC GVCF), homozygous-reference&#10; sites are compressed into bands of similar genotype quality (GQ) that are emitted as a single VCF record. See&#10; the FAQ documentation for more details about the GVCF format.&#10;&#10; This argument allows you to set the GQ bands. HC expects a list of strictly increasing GQ values&#10; that will act as exclusive upper bounds for the GQ bands. To pass multiple values,&#10; you provide them one by one with the argument, as in `-GQB 10 -GQB 20 -GQB 30` and so on&#10; (this would set the GQ bands to be `[0, 10), [10, 20), [20, 30)` and so on, for example).&#10; Note that GQ values are capped at 99 in the GATK, so values must be integers in [1, 100].&#10; If the last value is strictly less than 100, the last GQ band will start at that value (inclusive)&#10; and end at 100 (exclusive)."/>
      <param name="indel_size_to_eliminate_in_ref_model" argument="--indel-size-to-eliminate-in-ref-model" type="integer" optional="true" value="10" label="Indel Size To Eliminate In Ref Model" help="The size of an indel to check for in the reference model. This parameter determines the maximum size of an indel considered as potentially segregating in the&#10; reference model.  It is used to eliminate reads from being indel informative at a site, and determines&#10; by that mechanism the certainty in the reference base.  Conceptually, setting this parameter to&#10; X means that each informative read is consistent with any indel of size &amp;lt; X being present at a specific&#10; position in the genome, given its alignment to the reference."/>
      <param name="kmer_size" argument="--kmer-size" type="integer" optional="true" value="" label="Kmer Size" help="Kmer size to use in the read threading assembler. Multiple kmer sizes can be specified, using e.g. `--kmer-size 10 --kmer-size 25`."/>
      <param name="max_alternate_alleles" argument="--max-alternate-alleles" type="integer" optional="true" value="6" label="Max Alternate Alleles" help="Maximum number of alternate alleles to genotype. If there are more than this number of alternate alleles presented to the genotyper (either through discovery or GENOTYPE_GIVEN ALLELES),&#10; then only this many alleles will be used.  Note that genotyping sites with many alternate alleles is both CPU and memory intensive and it&#10; scales exponentially based on the number of alternate alleles.  Unless there is a good reason to change the default value, we highly recommend&#10; that you not play around with this parameter.&#10;&#10; See also {@link #MAX_GENOTYPE_COUNT}."/>
      <param name="max_genotype_count" argument="--max-genotype-count" type="integer" optional="true" value="1024" label="Max Genotype Count" help="Maximum number of genotypes to consider at any site. If there are more than this number of genotypes at a locus presented to the genotyper, then only this many genotypes will be used.&#10; The possible genotypes are simply different ways of partitioning alleles given a specific ploidy asumption.&#10; Therefore, we remove genotypes from consideration by removing alternate alleles that are the least well supported.&#10; The estimate of allele support is based on the ranking of the candidate haplotypes coming out of the graph building step.&#10; Note that the reference allele is always kept.&#10;&#10; Note that genotyping sites with large genotype counts is both CPU and memory intensive.&#10; Unless there is a good reason to change the default value, we highly recommend that you not play around with this parameter.&#10;&#10; The maximum number of alternative alleles used in the genotyping step will be the lesser of the two:&#10; 1. the largest number of alt alleles, given ploidy, that yields a genotype count no higher than {@link #MAX_GENOTYPE_COUNT}&#10; 2. the value of {@link #MAX_ALTERNATE_ALLELES}&#10;&#10; See also {@link #MAX_ALTERNATE_ALLELES}."/>
      <param name="max_mnp_distance" argument="--max-mnp-distance" type="integer" optional="true" value="0" label="Max Mnp Distance" help="Two or more phased substitutions separated by this distance or less are merged into MNPs. Two or more phased substitutions separated by this distance or less are merged into MNPs."/>
      <param name="max_num_haplotypes_in_population" argument="--max-num-haplotypes-in-population" type="integer" optional="true" value="128" label="Max Num Haplotypes In Population" help="Maximum number of haplotypes to consider for your population. The assembly graph can be quite complex, and could imply a very large number of possible haplotypes.  Each haplotype&#10; considered requires N PairHMM evaluations if there are N reads across all samples.  In order to control the&#10; run of the haplotype caller we only take maxNumHaplotypesInPopulation paths from the graph, in order of their&#10; weights, no matter how many paths are possible to generate from the graph.  Putting this number too low&#10; will result in dropping true variation because paths that include the real variant are not even considered.&#10; You can consider increasing this number when calling organisms with high heterozygosity."/>
      <param name="max_prob_propagation_distance" argument="--max-prob-propagation-distance" type="integer" optional="true" value="50" label="Max Prob Propagation Distance" help="Upper limit on how many bases away probability mass can be moved around when calculating the boundaries between active and inactive assembly regions. "/>
      <param name="max_unpruned_variants" argument="--max-unpruned-variants" type="integer" optional="true" value="100" label="Max Unpruned Variants" help="Maximum number of variants in graph the adaptive pruner will allow. The maximum number of variants in graph the adaptive pruner will allow"/>
      <param name="min_dangling_branch_length" argument="--min-dangling-branch-length" type="integer" optional="true" value="4" label="Min Dangling Branch Length" help="Minimum length of a dangling branch to attempt recovery. When constructing the assembly graph we are often left with &amp;quot;dangling&amp;quot; branches.  The assembly engine attempts to rescue these branches&#10; by merging them back into the main graph.  This argument describes the minimum length of a dangling branch needed for the engine to&#10; try to rescue it.  A smaller number here will lead to higher sensitivity to real variation but also to a higher number of false positives."/>
      <param name="min_pruning" argument="--min-pruning" type="integer" optional="true" value="2" label="Min Pruning" help="Minimum support to not prune paths in the graph. Paths with fewer supporting kmers than the specified threshold will be pruned from the graph.&#10;&#10; Be aware that this argument can dramatically affect the results of variant calling and should only be used with great caution.&#10; Using a prune factor of 1 (or below) will prevent any pruning from the graph, which is generally not ideal; it can make the&#10; calling much slower and even less accurate (because it can prevent effective merging of &amp;quot;tails&amp;quot; in the graph).  Higher values&#10; tend to make the calling much faster, but also lowers the sensitivity of the results (because it ultimately requires higher&#10; depth to produce calls)."/>
      <param name="num_pruning_samples" argument="--num-pruning-samples" type="integer" optional="true" value="1" label="Num Pruning Samples" help="Number of samples that must pass the minPruning threshold. If fewer samples than the specified number pass the minPruning threshold for a given path, that path will be eliminated from the graph."/>
      <param name="pair_hmm_gap_continuation_penalty" argument="--pair-hmm-gap-continuation-penalty" type="integer" optional="true" value="10" label="Pair Hmm Gap Continuation Penalty" help="Flat gap continuation penalty for use in the Pair HMM. "/>
      <param name="pair_hmm_implementation" argument="--pair-hmm-implementation" type="select" optional="true" label="Pair Hmm Implementation" help="The PairHMM implementation to use for genotype likelihood calculations. The PairHMM implementation to use for genotype likelihood calculations. The various implementations balance a tradeoff of accuracy and runtime.">
        <option value="EXACT">EXACT</option>
        <option value="ORIGINAL">ORIGINAL</option>
        <option value="LOGLESS_CACHING">LOGLESS_CACHING</option>
        <option value="AVX_LOGLESS_CACHING">AVX_LOGLESS_CACHING</option>
        <option value="AVX_LOGLESS_CACHING_OMP">AVX_LOGLESS_CACHING_OMP</option>
        <option value="EXPERIMENTAL_FPGA_LOGLESS_CACHING">EXPERIMENTAL_FPGA_LOGLESS_CACHING</option>
        <option selected="true" value="FASTEST_AVAILABLE">FASTEST_AVAILABLE</option>
      </param>
      <param name="pcr_indel_model" argument="--pcr-indel-model" type="select" optional="true" label="Pcr Indel Model" help="The PCR indel model to use. When calculating the likelihood of variants, we can try to correct for PCR errors that cause indel artifacts.&#10; The correction is based on the reference context, and acts specifically around repetitive sequences that tend&#10; to cause PCR errors). The variant likelihoods are penalized in increasing scale as the context around a&#10; putative indel is more repetitive (e.g. long homopolymer). The correction can be disabling by specifying&#10; &amp;apos;-pcrModel NONE&amp;apos;; in that case the default base insertion/deletion qualities will be used (or taken from the&#10; read if generated through the BaseRecalibrator). &amp;lt;b&amp;gt;VERY IMPORTANT: when using PCR-free sequencing data we&#10; definitely recommend setting this argument to NONE&amp;lt;/b&amp;gt;.">
        <option value="NONE">NONE</option>
        <option value="HOSTILE">HOSTILE</option>
        <option value="AGGRESSIVE">AGGRESSIVE</option>
        <option selected="true" value="CONSERVATIVE">CONSERVATIVE</option>
      </param>
      <param name="phred_scaled_global_read_mismapping_rate" argument="--phred-scaled-global-read-mismapping-rate" type="integer" optional="true" value="45" label="Phred Scaled Global Read Mismapping Rate" help="The global assumed mismapping rate for reads. The phredScaledGlobalReadMismappingRate reflects the average global mismapping rate of all reads, regardless of their&#10; mapping quality.  This term effects the probability that a read originated from the reference haplotype, regardless of&#10; its edit distance from the reference, in that the read could have originated from the reference haplotype but&#10; from another location in the genome.  Suppose a read has many mismatches from the reference, say like 5, but&#10; has a very high mapping quality of 60.  Without this parameter, the read would contribute 5 * Q30 evidence&#10; in favor of its 5 mismatch haplotype compared to reference, potentially enough to make a call off that single&#10; read for all of these events.  With this parameter set to Q30, though, the maximum evidence against any haplotype&#10; that this (and any) read could contribute is Q30.&#10;&#10; Set this term to any negative number to turn off the global mapping rate."/>
      <param name="pruning_lod_threshold" argument="--pruning-lod-threshold" type="float" optional="true" value="2.302585092994046" label="Pruning Lod Threshold" help="Ln likelihood ratio threshold for adaptive pruning algorithm. Log-10 likelihood ratio threshold for adaptive pruning algorithm."/>
      <param name="recover_all_dangling_branches" argument="--recover-all-dangling-branches" type="boolean" truevalue="--recover-all-dangling-branches" falsevalue="" optional="true" checked="false" label="Recover All Dangling Branches" help="Recover all dangling branches. By default, the read threading assembler does not recover dangling branches that fork after splitting from the reference.  This argument&#10; tells the assembly engine to recover all dangling branches."/>
      <param name="smith_waterman" argument="--smith-waterman" type="select" optional="true" label="Smith Waterman" help="Which Smith-Waterman implementation to use, generally FASTEST_AVAILABLE is the right choice. ">
        <option value="FASTEST_AVAILABLE">FASTEST_AVAILABLE</option>
        <option value="AVX_ENABLED">AVX_ENABLED</option>
        <option selected="true" value="JAVA">JAVA</option>
      </param>
      <param name="use_filtered_reads_for_annotations" argument="--use-filtered-reads-for-annotations" type="boolean" truevalue="--use-filtered-reads-for-annotations" falsevalue="" optional="true" checked="false" label="Use Filtered Reads For Annotations" help="Use the contamination-filtered read maps for the purposes of annotating variants. "/>
    </section>
    <section name="common" title="Common Parameters" expanded="False">
      <expand macro="gatk_excl_ints"/>
      <expand macro="seq_dict_sel"/>
      <param name="add_output_sam_program_record" argument="--add-output-sam-program-record" type="boolean" truevalue="--add-output-sam-program-record" falsevalue="" optional="true" checked="true" label="Add Output Sam Program Record" help="If true, adds a PG tag to created SAM/BAM/CRAM files. "/>
      <param name="add_output_vcf_command_line" argument="--add-output-vcf-command-line" type="boolean" truevalue="--add-output-vcf-command-line" falsevalue="" optional="true" checked="true" label="Add Output Vcf Command Line" help="If true, adds a command line header line to created VCF files. "/>
      <repeat name="disable_read_filter_rpt" default="1" title="Disable Read Filter">
        <param name="disable_read_filter" argument="--disable-read-filter" type="text" optional="true" value="" label="Disable Read Filter" help="Read filters to be disabled before analysis. "/>
      </repeat>
      <param name="disable_tool_default_read_filters" argument="--disable-tool-default-read-filters" type="boolean" truevalue="--disable-tool-default-read-filters" falsevalue="" optional="true" checked="false" label="Disable Tool Default Read Filters" help="Disable all tool default read filters (WARNING: many tools will not function correctly without their default read filters on). "/>
      <param name="gatk_config_file" argument="--gatk-config-file" type="data" optional="true" format="txt" label="Gatk Config File" help="A configuration file to use with the GATK. "/>
      <param name="interval_set_rule" argument="--interval-set-rule" type="select" optional="true" label="Interval Set Rule" help="Set merging approach to use for combining interval inputs. By default, the program will take the UNION of all intervals specified using -L and/or -XL. However, you can&#10; change this setting for -L, for example if you want to take the INTERSECTION of the sets instead. E.g. to&#10; perform the analysis only on chromosome 1 exomes, you could specify -L exomes.intervals -L 1 --interval-set-rule&#10; INTERSECTION. However, it is not possible to modify the merging approach for intervals passed using -XL (they will&#10; always be merged using UNION).&#10;&#10; Note that if you specify both -L and -XL, the -XL interval set will be subtracted from the -L interval set.">
        <option selected="true" value="UNION">UNION</option>
        <option value="INTERSECTION">INTERSECTION</option>
      </param>
      <param name="lenient" argument="--lenient" type="boolean" truevalue="--lenient" falsevalue="" optional="true" checked="false" label="Lenient" help="Lenient processing of VCF files. "/>
      <param name="QUIET" argument="--QUIET" type="boolean" truevalue="--QUIET" falsevalue="" optional="true" checked="false" label="Quiet" help="Whether to suppress job-summary info on System.err. "/>
      <repeat name="read_filter_rpt" default="1" title="Read Filter">
        <param name="read_filter" argument="--read-filter" type="text" optional="true" value="" label="Read Filter" help="Read filters to be applied before analysis. "/>
      </repeat>
      <param name="read_validation_stringency" argument="--read-validation-stringency" type="select" optional="true" label="Read Validation Stringency" help="Validation stringency for all SAM/BAM/CRAM/SRA files read by this program.  The default stringency value SILENT can improve performance when processing a BAM file in which variable-length data (read, qualities, tags) do not otherwise need to be decoded. ">
        <option value="STRICT">STRICT</option>
        <option value="LENIENT">LENIENT</option>
        <option selected="true" value="SILENT">SILENT</option>
      </param>
      <param name="seconds_between_progress_updates" argument="--seconds-between-progress-updates" type="float" optional="true" value="10.0" label="Seconds Between Progress Updates" help="Output traversal statistics every time this many seconds elapse. "/>
      <param name="tmp_dir" argument="--tmp-dir" type="text" optional="true" value="" label="Tmp Dir" help="Temp directory to use. "/>
      <param name="use_jdk_deflater" argument="--use-jdk-deflater" type="boolean" truevalue="--use-jdk-deflater" falsevalue="" optional="true" checked="false" label="Use Jdk Deflater" help="Whether to use the JdkDeflater (as opposed to IntelDeflater). "/>
      <param name="use_jdk_inflater" argument="--use-jdk-inflater" type="boolean" truevalue="--use-jdk-inflater" falsevalue="" optional="true" checked="false" label="Use Jdk Inflater" help="Whether to use the JdkInflater (as opposed to IntelInflater). "/>
      <param name="verbosity" argument="--verbosity" type="select" optional="true" label="Verbosity" help="Control verbosity of logging. ">
        <option value="ERROR">ERROR</option>
        <option value="WARNING">WARNING</option>
        <option selected="true" value="INFO">INFO</option>
        <option value="DEBUG">DEBUG</option>
      </param>
    </section>
    <section name="deprecated" title="Deprecated Parameters" expanded="False">
      <param name="recover_dangling_heads" argument="--recover-dangling-heads" type="boolean" truevalue="--recover-dangling-heads" falsevalue="" optional="true" checked="false" label="Recover Dangling Heads" help="This argument is deprecated since version 3.3. As of version 3.3, this argument is no longer needed because dangling end recovery is now the default behavior. See GATK 3.3 release notes for more details."/>
    </section>
    <section name="output_opt" title="Additional Output Parameters" expanded="False">
      <param name="assembly_region_out_sel" argument="--assembly_region_out_sel" type="boolean" truevalue="--assembly_region_out_sel" falsevalue="" optional="true" checked="false" label="Assembly Region Out" help="Output the assembly region to this IGV formatted file. If provided, this walker will write out its assembly regions&#10; to this file in the IGV formatted TAB-delimited output:&#10;&#10; http://www.broadinstitute.org/software/igv/IGV&#10;&#10; Intended to make debugging the active region calculations easier"/>
      <param name="bam_output_sel" argument="--bam_output_sel" type="boolean" truevalue="--bam_output_sel" falsevalue="" optional="true" checked="false" label="Bam Output" help="File to which assembled haplotypes should be written. The assembled haplotypes and locally realigned reads will be written as BAM to this file if requested.  Really&#10; for debugging purposes only. Note that the output here does not include uninformative reads so that not every&#10; input read is emitted to the bam.&#10;&#10; Turning on this mode may result in serious performance cost for the caller.  It&amp;apos;s really only appropriate to&#10; use in specific areas where you want to better understand why the caller is making specific calls.&#10;&#10; The reads are written out containing an &amp;quot;HC&amp;quot; tag (integer) that encodes which haplotype each read best matches&#10; according to the haplotype caller&amp;apos;s likelihood calculation.  The use of this tag is primarily intended&#10; to allow good coloring of reads in IGV.  Simply go to &amp;quot;Color Alignments By &amp;gt; Tag&amp;quot; and enter &amp;quot;HC&amp;quot; to more&#10; easily see which reads go with these haplotype.&#10;&#10; Note that the haplotypes (called or all, depending on mode) are emitted as single reads covering the entire&#10; active region, coming from sample &amp;quot;HC&amp;quot; and a special read group called &amp;quot;ArtificialHaplotype&amp;quot;. This will increase the&#10; pileup depth compared to what would be expected from the reads only, especially in complex regions.&#10;&#10; Note also that only reads that are actually informative about the haplotypes are emitted.  By informative we mean&#10; that there&amp;apos;s a meaningful difference in the likelihood of the read coming from one haplotype compared to&#10; its next best haplotype.&#10;&#10; If multiple BAMs are passed as input to the tool (as is common for M2), then they will be combined in the bamout&#10; output and tagged with the appropriate sample names.&#10;&#10; The best way to visualize the output of this mode is with IGV.  Tell IGV to color the alignments by tag,&#10; and give it the &amp;quot;HC&amp;quot; tag, so you can see which reads support each haplotype.  Finally, you can tell IGV&#10; to group by sample, which will separate the potential haplotypes from the reads.  All of this can be seen in&#10; &amp;lt;a href=&amp;quot;https://www.dropbox.com/s/xvy7sbxpf13x5bp/haplotypecaller%20bamout%20for%20docs.png&amp;quot;&amp;gt;this screenshot&amp;lt;/a&amp;gt;"/>
      <param name="debug_assembly_sel" argument="--debug_assembly_sel" type="boolean" truevalue="--debug_assembly_sel" falsevalue="" optional="true" checked="false" label="Debug Assembly" help="Print out verbose debug information about each assembly region. "/>
      <param name="graph_output_sel" argument="--graph_output_sel" type="boolean" truevalue="--graph_output_sel" falsevalue="" optional="true" checked="false" label="Graph Output" help="Write debug assembly graph information to this file. This argument is meant for debugging and is not immediately useful for normal analysis use."/>
    </section>
  </inputs>
  <outputs>
    <expand macro="gzip_vcf_output_params"/>
    <data format="tabular" name="assembly_region_out" label="${tool.name} on ${on_string}: assembly_region_out tabular">
      <filter>output_opt['assembly_region_out_sel']</filter>
    </data>
    <data format="bam" name="bam_output" label="${tool.name} on ${on_string}: bam_output bam">
      <filter>output_opt['bam_output_sel']</filter>
    </data>
    <data format="txt" name="debug_assembly" label="${tool.name} on ${on_string}: debug_assembly txt">
      <filter>output_opt['debug_assembly_sel']</filter>
    </data>
    <data format="txt" name="graph_output" label="${tool.name} on ${on_string}: graph_output txt">
      <filter>output_opt['graph_output_sel']</filter>
    </data>
  </outputs>
  <tests/>
  <help><![CDATA[Call germline SNPs and indels via local re-assembly of haplotypes

The HaplotypeCaller is capable of calling SNPs and indels simultaneously
via local de-novo assembly of haplotypes in an active region. In other
words, whenever the program encounters a region showing signs of
variation, it discards the existing mapping information and completely
reassembles the reads in that region. This allows the HaplotypeCaller to
be more accurate when calling regions that are traditionally difficult
to call, for example when they contain different types of variants close
to each other. It also makes the HaplotypeCaller much better at calling
indels than position-based callers like UnifiedGenotyper.

In the GVCF workflow used for scalable variant calling in DNA sequence
data, HaplotypeCaller runs per-sample to generate an intermediate GVCF
(not to be used in final analysis), which can then be used in
GenotypeGVCFs for joint genotyping of multiple samples in a very
efficient way. The GVCF workflow enables rapid incremental processing of
samples as they roll off the sequencer, as well as scaling to very large
cohort sizes (e.g. the 92K exomes of ExAC).

In addition, HaplotypeCaller is able to handle non-diploid organisms as
well as pooled experiment data. Note however that the algorithms used to
calculate variant likelihoods is not well suited to extreme allele
frequencies (relative to ploidy) so its use is not recommended for
somatic (cancer) variant discovery. For that purpose, use Mutect2
instead.

Finally, HaplotypeCaller is also able to correctly handle the splice
junctions that make RNAseq a challenge for most variant callers, on the
condition that the input read data has previously been processed
according to our recommendations as documented
`here <https://software.broadinstitute.org/gatk/documentation/article?id=4067>`__.

How HaplotypeCaller works
~~~~~~~~~~~~~~~~~~~~~~~~~

| 

`1. Define active regions <https://software.broadinstitute.org/gatk/documentation/article?id=4147>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

| The program determines which regions of the genome it needs to operate
  on (active regions), based on the presence of evidence for variation.

`2. Determine haplotypes by assembly of the active region <https://software.broadinstitute.org/gatk/documentation/article?id=4146>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

For each active region, the program builds a De Bruijn-like graph to
reassemble the active region and identifies what are the possible
haplotypes present in the data. The program then realigns each haplotype
against the reference haplotype using the Smith-Waterman algorithm in
order to identify potentially variant sites.

| 

`3. Determine likelihoods of the haplotypes given the read data <https://software.broadinstitute.org/gatk/documentation/article?id=4441>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

For each active region, the program performs a pairwise alignment of
each read against each haplotype using the PairHMM algorithm. This
produces a matrix of likelihoods of haplotypes given the read data.
These likelihoods are then marginalized to obtain the likelihoods of
alleles for each potentially variant site given the read data.

| 

`4. Assign sample genotypes <https://software.broadinstitute.org/gatk/documentation/article?id=4442>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

For each potentially variant site, the program applies Bayes' rule,
using the likelihoods of alleles given the read data to calculate the
likelihoods of each genotype per sample given the read data observed for
that sample. The most likely genotype is then assigned to the sample.

Input
~~~~~

Input bam file(s) from which to make variant calls

Output
~~~~~~

Either a VCF or GVCF file with raw, unfiltered SNP and indel calls.
Regular VCFs must be filtered either by variant recalibration (Best
Practice) or hard-filtering before use in downstream analyses. If using
the GVCF workflow, the output is a GVCF file that must first be run
through GenotypeGVCFs and then filtering before further analysis.

Usage examples
~~~~~~~~~~~~~~

These are example commands that show how to run HaplotypeCaller for
typical use cases. Have a look at the `method
documentation <https://software.broadinstitute.org/gatk/documentation/article?id=3893>`__
for the basic GVCF workflow.

| 

Single-sample GVCF calling (outputs intermediate GVCF)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    gatk --java-options "-Xmx4g" HaplotypeCaller  \
      -R Homo_sapiens_assembly38.fasta \
      -I input.bam \
      -O output.g.vcf.gz \
      -ERC GVCF
    

Single-sample GVCF calling with `allele-specific annotations <https://software.broadinstitute.org/gatk/documentation/article?id=9622>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    gatk --java-options "-Xmx4g" HaplotypeCaller  \
      -R Homo_sapiens_assembly38.fasta \
      -I input.bam \
      -O output.g.vcf.gz \
      -ERC GVCF \
      -G Standard \
      -G AS_Standard
    

Variant calling with `bamout <https://software.broadinstitute.org/gatk/documentation/article?id=5484>`__ to show realigned reads
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    gatk --java-options "-Xmx4g" HaplotypeCaller  \
      -R Homo_sapiens_assembly38.fasta \
      -I input.bam \
      -O output.vcf.gz \
      -bamout bamout.bam
    

Caveats
~~~~~~~

-  We have not yet fully tested the interaction between the GVCF-based
   calling or the multisample calling and the RNAseq-specific
   functionalities. Use those in combination at your own risk.

Special note on ploidy
~~~~~~~~~~~~~~~~~~~~~~

This tool is able to handle many non-diploid use cases; the desired
ploidy can be specified using the -ploidy argument. Note however that
very high ploidies (such as are encountered in large pooled experiments)
may cause performance challenges including excessive slowness. We are
working on resolving these limitations.

Additional Notes
~~~~~~~~~~~~~~~~

-  When working with PCR-free data, be sure to set \`-pcr_indel_model
   NONE\` (see argument below).
-  When running in \`-ERC GVCF\` or \`-ERC BP_RESOLUTION\` modes, the
   confidence threshold is automatically set to 0. This cannot be
   overridden by the command line. The threshold can be set manually to
   the desired level in the next step of the workflow (GenotypeGVCFs)
-  We recommend using a list of intervals to speed up analysis. See
   `this
   document <https://software.broadinstitute.org/gatk/documentation/article?id=4133>`__
   for details.
]]></help>
  <citations>
    <expand macro="citations"/>
  </citations>
</tool>
