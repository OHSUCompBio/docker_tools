<tool id="gatk4_auto_mutect2" name="GATK4 AUTO Mutect2" version="@WRAPPER_VERSION@0" profile="18.01">
  <description>- Call somatic SNVs and indels via local assembly of haplotypes</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="version_cmd"/>
  <command detect_errors="exit_code"><![CDATA[#include source=$set_sections#
#if $optional.alleles
#set datatype = $optional.alleles.datatype
#if $optional.alleles.is_of_type("vcf_bgzip")
ln -s $optional.alleles alleles.vcf.gz &&
tabix alleles.vcf.gz &&
#else
ln -s $optional.alleles alleles.vcf &&
gatk IndexFeatureFile -I alleles.vcf &&
#end if
#end if
#include source=$pre_gatk_excl_ints_chth#
#if $optional.germline_resource
#set datatype = $optional.germline_resource.datatype
#if $optional.germline_resource.is_of_type("vcf_bgzip")
ln -s $optional.germline_resource germline_resource.vcf.gz &&
tabix germline_resource.vcf.gz &&
#else
ln -s $optional.germline_resource germline_resource.vcf &&
gatk IndexFeatureFile -I germline_resource.vcf &&
#end if
#end if
#include source=$bam_index_pre_chth_req#
#include source=$pre_gatk_ints_chth#
#if $optional.panel_of_normals
#set datatype = $optional.panel_of_normals.datatype
#if $optional.panel_of_normals.is_of_type("vcf_bgzip")
ln -s $optional.panel_of_normals panel_of_normals.vcf.gz &&
tabix panel_of_normals.vcf.gz &&
#else
ln -s $optional.panel_of_normals panel_of_normals.vcf &&
gatk IndexFeatureFile -I panel_of_normals.vcf &&
#end if
#end if
@CMD_BEGIN@ Mutect2
#if $advanced.active_probability_threshold
  --active-probability-threshold $advanced.active_probability_threshold
#end if

#if $advanced.adaptive_pruning_initial_error_rate
  --adaptive-pruning-initial-error-rate $advanced.adaptive_pruning_initial_error_rate
#end if

#if $common.add_output_sam_program_record
  $common.add_output_sam_program_record
#end if

#if $common.add_output_vcf_command_line
  $common.add_output_vcf_command_line
#end if

#if $optional.af_of_alleles_not_in_resource
  --af-of-alleles-not-in-resource $optional.af_of_alleles_not_in_resource
#end if

#if $advanced.allele_informative_reads_overlap_margin
  --allele-informative-reads-overlap-margin $advanced.allele_informative_reads_overlap_margin
#end if

#if $optional.alleles
#if $optional.alleles.is_of_type("vcf_bgzip")
--alleles alleles.vcf.gz
#else
--alleles alleles.vcf
#end if
#end if
#if $advanced.allow_non_unique_kmers_in_ref
  $advanced.allow_non_unique_kmers_in_ref
#end if

#for $num, $txt in enumerate($optional.annotation_rpt)
#if $txt.annotation
--annotation '$txt.annotation'
#end if
#end for
#for $num, $txt in enumerate($optional.annotation_group_rpt)
#if $txt.annotation_group
--annotation-group '$txt.annotation_group'
#end if
#end for
#for $num, $txt in enumerate($optional.annotations_to_exclude_rpt)
#if $txt.annotations_to_exclude
--annotations-to-exclude '$txt.annotations_to_exclude'
#end if
#end for
#if $optional.arguments_file
  --arguments_file $optional.arguments_file
#end if

#if $output_opt.assembly_region_out_sel
--assembly-region-out $assembly_region_out
#end if
#if $optional.assembly_region_padding
  --assembly-region-padding $optional.assembly_region_padding
#end if

#if $output_opt.bam_output_sel
--bam-output $bam_output
#end if
#if $advanced.bam_writer_type
  --bam-writer-type $advanced.bam_writer_type
#end if

#if $optional.base_quality_score_threshold
  --base-quality-score-threshold $optional.base_quality_score_threshold
#end if

#if $optional.callable_depth
  --callable-depth $optional.callable_depth
#end if

#if $optional.cloud_index_prefetch_buffer
  --cloud-index-prefetch-buffer $optional.cloud_index_prefetch_buffer
#end if

#if $optional.cloud_prefetch_buffer
  --cloud-prefetch-buffer $optional.cloud_prefetch_buffer
#end if

#if $output_opt.debug_assembly_sel
--debug-assembly $debug_assembly
#end if
#if $advanced.disable_adaptive_pruning
  $advanced.disable_adaptive_pruning
#end if

#if $optional.disable_bam_index_caching
  $optional.disable_bam_index_caching
#end if

#for $num, $txt in enumerate($common.disable_read_filter_rpt)
#if $txt.disable_read_filter
--disable-read-filter '$txt.disable_read_filter'
#end if
#end for
#if $optional.disable_sequence_dictionary_validation
  $optional.disable_sequence_dictionary_validation
#end if

#if $advanced.disable_tool_default_annotations
  $advanced.disable_tool_default_annotations
#end if

#if $common.disable_tool_default_read_filters
  $common.disable_tool_default_read_filters
#end if

#if $advanced.dont_increase_kmer_sizes_for_cycles
  $advanced.dont_increase_kmer_sizes_for_cycles
#end if

#if $advanced.dont_use_soft_clipped_bases
  $advanced.dont_use_soft_clipped_bases
#end if

#if $optional.downsampling_stride
  --downsampling-stride $optional.downsampling_stride
#end if

#if $advanced.emit_ref_confidence
  --emit-ref-confidence $advanced.emit_ref_confidence
#end if

#if $advanced.enable_all_annotations
  $advanced.enable_all_annotations
#end if

#include source=$gatk_excl_ints_chth#
#if $optional.f1r2_max_depth
  --f1r2-max-depth $optional.f1r2_max_depth
#end if

#if $optional.f1r2_median_mq
  --f1r2-median-mq $optional.f1r2_median_mq
#end if

#if $optional.f1r2_min_bq
  --f1r2-min-bq $optional.f1r2_min_bq
#end if

#if $output_opt.f1r2_tar_gz_sel
--f1r2-tar-gz f1r2_tar_gz.tar.gz
#end if
#if $advanced.force_active
  $advanced.force_active
#end if

#if $advanced.force_call_filtered_alleles
  $advanced.force_call_filtered_alleles
#end if

#for $num, $txt in enumerate($optional.founder_id_rpt)
#if $txt.founder_id
--founder-id '$txt.founder_id'
#end if
#end for
#if $common.gatk_config_file
  --gatk-config-file $common.gatk_config_file
#end if

#if $optional.gcs_max_retries
  --gcs-max-retries $optional.gcs_max_retries
#end if

#if $optional.genotype_germline_sites
  $optional.genotype_germline_sites
#end if

#if $optional.genotype_pon_sites
  $optional.genotype_pon_sites
#end if

#if $optional.germline_resource
#if $optional.germline_resource.is_of_type("vcf_bgzip")
--germline-resource germline_resource.vcf.gz
#else
--germline-resource germline_resource.vcf
#end if
#end if
#if $output_opt.graph_output_sel
--graph-output $graph_output
#end if
#for $num, $txt in enumerate($advanced.gvcf_lod_band_rpt)
#if $txt.gvcf_lod_band
--gvcf-lod-band '$txt.gvcf_lod_band'
#end if
#end for
#if $optional.ignore_itr_artifacts
  $optional.ignore_itr_artifacts
#end if

#if $advanced.independent_mates
  $advanced.independent_mates
#end if

#if $optional.initial_tumor_lod
  --initial-tumor-lod $optional.initial_tumor_lod
#end if

#include source=$gatk_bam_input_req#
#if $optional.interval_merging_rule
  --interval-merging-rule $optional.interval_merging_rule
#end if

#if $common.interval_set_rule
  --interval-set-rule $common.interval_set_rule
#end if

#include source=$gatk_ints_chth#
#if $advanced.kmer_size
  --kmer-size $advanced.kmer_size
#end if

#if $common.lenient
  $common.lenient
#end if

#if $optional.max_assembly_region_size
  --max-assembly-region-size $optional.max_assembly_region_size
#end if

#if $advanced.max_mnp_distance
  --max-mnp-distance $advanced.max_mnp_distance
#end if

#if $advanced.max_num_haplotypes_in_population
  --max-num-haplotypes-in-population $advanced.max_num_haplotypes_in_population
#end if

#if $optional.max_population_af
  --max-population-af $optional.max_population_af
#end if

#if $advanced.max_prob_propagation_distance
  --max-prob-propagation-distance $advanced.max_prob_propagation_distance
#end if

#if $optional.max_reads_per_alignment_start
  --max-reads-per-alignment-start $optional.max_reads_per_alignment_start
#end if

#if $advanced.max_suspicious_reads_per_alignment_start
  --max-suspicious-reads-per-alignment-start $advanced.max_suspicious_reads_per_alignment_start
#end if

#if $advanced.max_unpruned_variants
  --max-unpruned-variants $advanced.max_unpruned_variants
#end if

#if $optional.min_assembly_region_size
  --min-assembly-region-size $optional.min_assembly_region_size
#end if

#if $optional.min_base_quality_score
  --min-base-quality-score $optional.min_base_quality_score
#end if

#if $advanced.min_dangling_branch_length
  --min-dangling-branch-length $advanced.min_dangling_branch_length
#end if

#if $advanced.min_pruning
  --min-pruning $advanced.min_pruning
#end if

#if $advanced.minimum_allele_fraction
  --minimum-allele-fraction $advanced.minimum_allele_fraction
#end if

#if $optional.mitochondria_mode
  --mitochondria-mode $optional.mitochondria_mode
#end if

#if $optional.native_pair_hmm_threads
  --native-pair-hmm-threads $optional.native_pair_hmm_threads
#end if

#if $optional.native_pair_hmm_use_double_precision
  $optional.native_pair_hmm_use_double_precision
#end if

#if $optional.normal_lod
  --normal-lod $optional.normal_lod
#end if

#for $num, $txt in enumerate($optional.normal_sample_rpt)
#if $txt.normal_sample
--normal-sample '$txt.normal_sample'
#end if
#end for
#if $advanced.num_pruning_samples
  --num-pruning-samples $advanced.num_pruning_samples
#end if

#include source=$vcf_output_opts#
#if $advanced.pair_hmm_gap_continuation_penalty
  --pair-hmm-gap-continuation-penalty $advanced.pair_hmm_gap_continuation_penalty
#end if

#if $advanced.pair_hmm_implementation
  --pair-hmm-implementation $advanced.pair_hmm_implementation
#end if

#if $optional.panel_of_normals
#if $optional.panel_of_normals.is_of_type("vcf_bgzip")
--panel-of-normals panel_of_normals.vcf.gz
#else
--panel-of-normals panel_of_normals.vcf
#end if
#end if
#if $advanced.pcr_indel_model
  --pcr-indel-model $advanced.pcr_indel_model
#end if

#if $optional.pcr_indel_qual
  --pcr-indel-qual $optional.pcr_indel_qual
#end if

#if $optional.pcr_snv_qual
  --pcr-snv-qual $optional.pcr_snv_qual
#end if

#if $optional.pedigree
  --pedigree $optional.pedigree
#end if

#if $advanced.phred_scaled_global_read_mismapping_rate
  --phred-scaled-global-read-mismapping-rate $advanced.phred_scaled_global_read_mismapping_rate
#end if

#if $advanced.pruning_lod_threshold
  --pruning-lod-threshold $advanced.pruning_lod_threshold
#end if

#if $common.QUIET
  --QUIET $common.QUIET
#end if

#for $num, $txt in enumerate($common.read_filter_rpt)
#if $txt.read_filter
--read-filter '$txt.read_filter'
#end if
#end for
#if $common.read_validation_stringency
  --read-validation-stringency $common.read_validation_stringency
#end if

#if $advanced.recover_all_dangling_branches
  $advanced.recover_all_dangling_branches
#end if

#include source=$ref_opts#
#if $common.seconds_between_progress_updates
  --seconds-between-progress-updates $common.seconds_between_progress_updates
#end if

#include source=$gatk_seqdict#
#if $optional.sites_only_vcf_output
  $optional.sites_only_vcf_output
#end if

#if $advanced.smith_waterman
  --smith-waterman $advanced.smith_waterman
#end if

#if $common.tmp_dir
  --tmp-dir $common.tmp_dir
#end if

#if $optional.tumor_lod_to_emit
  --tumor-lod-to-emit $optional.tumor_lod_to_emit
#end if

#if $deprecated.tumor_sample
  --tumor-sample $deprecated.tumor_sample
#end if

#if $common.use_jdk_deflater
  $common.use_jdk_deflater
#end if

#if $common.use_jdk_inflater
  $common.use_jdk_inflater
#end if

#if $common.verbosity
  --verbosity $common.verbosity
#end if
]]></command>
  <inputs>
    <expand macro="ref_sel"/>
    <expand macro="gzip_vcf_params"/>
    <expand macro="gatk_bam_req_params"/>
    <section name="optional" title="Optional Parameters" expanded="False">
      <expand macro="gatk_ints"/>
      <param name="af_of_alleles_not_in_resource" argument="--af-of-alleles-not-in-resource" type="float" optional="true" value="-1.0" label="Af Of Alleles Not In Resource" help="Population allele fraction assigned to alleles not found in germline resource.  Please see docs/mutect/mutect2.pdf fora derivation of the default value. Population allele fraction assigned to alleles not found in germline resource."/>
      <param name="alleles" argument="--alleles" type="data" optional="true" format="vcf,vcf_bgzip" label="Alleles" help="The set of alleles to force-call regardless of evidence. "/>
      <repeat name="annotation_rpt" default="1" title="Annotation">
        <param name="annotation" argument="--annotation" type="text" optional="true" value="" label="Annotation" help="One or more specific annotations to add to variant calls. Which annotations to include in variant calls in the output. These supplement annotations provided by annotation groups."/>
      </repeat>
      <repeat name="annotation_group_rpt" default="1" title="Annotation Group">
        <param name="annotation_group" argument="--annotation-group" type="text" optional="true" value="" label="Annotation Group" help="One or more groups of annotations to apply to variant calls. Which groups of annotations to add to the output variant calls.&#10; Any requirements that are not met (e.g. failing to provide a pedigree file for a pedigree-based annotation) may cause the run to fail."/>
      </repeat>
      <repeat name="annotations_to_exclude_rpt" default="1" title="Annotations To Exclude">
        <param name="annotations_to_exclude" argument="--annotations-to-exclude" type="text" optional="true" value="" label="Annotations To Exclude" help="One or more specific annotations to exclude from variant calls. Which annotations to exclude from output in the variant calls.  Note that this argument has higher priority than the&#10; -A or -G arguments, so these annotations will be excluded even if they are explicitly included with the other&#10; options."/>
      </repeat>
      <param name="arguments_file" argument="--arguments_file" type="data" optional="true" format="txt" label="Arguments_File" help="read one or more arguments files and add them to the command line. "/>
      <param name="assembly_region_padding" argument="--assembly-region-padding" type="integer" optional="true" value="100" label="Assembly Region Padding" help="Number of additional bases of context to include around each assembly region. Parameters that control assembly regions"/>
      <param name="base_quality_score_threshold" argument="--base-quality-score-threshold" type="integer" optional="true" value="18" label="Base Quality Score Threshold" help="Base qualities below this threshold will be reduced to the minimum (6). Bases with a quality below this threshold will reduced to the minimum usable qualiy score (6)."/>
      <param name="callable_depth" argument="--callable-depth" type="integer" optional="true" value="10" label="Callable Depth" help="Minimum depth to be considered callable for Mutect stats.  Does not affect genotyping. "/>
      <param name="cloud_index_prefetch_buffer" argument="--cloud-index-prefetch-buffer" type="integer" optional="true" value="-1" label="Cloud Index Prefetch Buffer" help="Size of the cloud-only prefetch buffer (in MB; 0 to disable). Defaults to cloudPrefetchBuffer if unset. "/>
      <param name="cloud_prefetch_buffer" argument="--cloud-prefetch-buffer" type="integer" optional="true" value="40" label="Cloud Prefetch Buffer" help="Size of the cloud-only prefetch buffer (in MB; 0 to disable). "/>
      <param name="disable_bam_index_caching" argument="--disable-bam-index-caching" type="boolean" truevalue="--disable-bam-index-caching" falsevalue="" optional="true" checked="false" label="Disable Bam Index Caching" help="If true, don&amp;apos;t cache bam indexes, this will reduce memory requirements but may harm performance if many intervals are specified.  Caching is automatically disabled if there are no intervals specified. "/>
      <param name="disable_sequence_dictionary_validation" argument="--disable-sequence-dictionary-validation" type="boolean" truevalue="--disable-sequence-dictionary-validation" falsevalue="" optional="true" checked="false" label="Disable Sequence Dictionary Validation" help="If specified, do not check the sequence dictionaries from our inputs for compatibility. Use at your own risk!. "/>
      <param name="downsampling_stride" argument="--downsampling-stride" type="integer" optional="true" value="1" label="Downsampling Stride" help="Downsample a pool of reads starting within a range of one or more bases. Downsample a pool of reads starting within a range of one or more bases."/>
      <param name="f1r2_max_depth" argument="--f1r2-max-depth" type="integer" optional="true" value="200" label="F1R2 Max Depth" help="sites with depth higher than this value will be grouped. "/>
      <param name="f1r2_median_mq" argument="--f1r2-median-mq" type="integer" optional="true" value="50" label="F1R2 Median Mq" help="skip sites with median mapping quality below this value. "/>
      <param name="f1r2_min_bq" argument="--f1r2-min-bq" type="integer" optional="true" value="20" label="F1R2 Min Bq" help="exclude bases below this quality from pileup. "/>
      <repeat name="founder_id_rpt" default="1" title="Founder Id">
        <param name="founder_id" argument="--founder-id" type="text" optional="true" value="" label="Founder Id" help="Samples representing the population &amp;quot;founders&amp;quot;. "/>
      </repeat>
      <param name="gcs_max_retries" argument="--gcs-max-retries" type="integer" optional="true" value="20" label="Gcs Max Retries" help="If the GCS bucket channel errors out, how many times it will attempt to re-initiate the connection. "/>
      <param name="genotype_germline_sites" argument="--genotype-germline-sites" type="boolean" truevalue="--genotype-germline-sites" falsevalue="" optional="true" checked="false" label="Genotype Germline Sites" help="(EXPERIMENTAL) Call all apparent germline site even though they will ultimately be filtered. Usually we exclude sites in the panel of normals from active region determination, which saves time.  Setting this to true&#10; causes Mutect to produce a variant call at these sites.  This call will still be filtered, but it shows up in the vcf."/>
      <param name="genotype_pon_sites" argument="--genotype-pon-sites" type="boolean" truevalue="--genotype-pon-sites" falsevalue="" optional="true" checked="false" label="Genotype Pon Sites" help="Call sites in the PoN even though they will ultimately be filtered. Usually we exclude sites in the panel of normals from active region determination, which saves time.  Setting this to true&#10; causes Mutect to produce a variant call at these sites.  This call will still be filtered, but it shows up in the vcf."/>
      <param name="germline_resource" argument="--germline-resource" type="data" optional="true" format="vcf,vcf_bgzip" label="Germline Resource" help="Population vcf of germline sequencing containing allele fractions. A resource, such as gnomAD, containing population allele frequencies of common and rare variants."/>
      <param name="ignore_itr_artifacts" argument="--ignore-itr-artifacts" type="boolean" truevalue="--ignore-itr-artifacts" falsevalue="" optional="true" checked="false" label="Ignore Itr Artifacts" help="Turn off read transformer that clips artifacts associated with end repair insertions near inverted tandem repeats. When opposite ends of a fragment are inverted tandem repeats of each other, the sequence past one end may be copied onto the other&#10; during library prep.  By default, Mutect2 identifies and clips these artifacts, which are especially prevalent when&#10; DNA is damaged as in the case of FFPE samples and ancient DNA."/>
      <param name="initial_tumor_lod" argument="--initial-tumor-lod" type="float" optional="true" value="2.0" label="Initial Tumor Lod" help="Log 10 odds threshold to consider pileup active. Only variants with estimated tumor LODs exceeding this threshold will be considered active."/>
      <param name="interval_merging_rule" argument="--interval-merging-rule" type="select" optional="true" label="Interval Merging Rule" help="Interval merging rule for abutting intervals. By default, the program merges abutting intervals (i.e. intervals that are directly side-by-side but do not&#10; actually overlap) into a single continuous interval. However you can change this behavior if you want them to be&#10; treated as separate intervals instead.">
        <option selected="true" value="ALL">ALL</option>
        <option value="OVERLAPPING_ONLY">OVERLAPPING_ONLY</option>
      </param>
      <param name="max_assembly_region_size" argument="--max-assembly-region-size" type="integer" optional="true" value="300" label="Max Assembly Region Size" help="Maximum size of an assembly region. "/>
      <param name="max_population_af" argument="--max-population-af" type="float" optional="true" value="0.01" label="Max Population Af" help="Maximum population allele frequency in tumor-only mode. In tumor-only mode, we discard variants with population allele frequencies greater than this threshold."/>
      <param name="max_reads_per_alignment_start" argument="--max-reads-per-alignment-start" type="integer" optional="true" value="50" label="Max Reads Per Alignment Start" help="Maximum number of reads to retain per alignment start position. Reads above this threshold will be downsampled. Set to 0 to disable. Other parameters"/>
      <param name="min_assembly_region_size" argument="--min-assembly-region-size" type="integer" optional="true" value="50" label="Min Assembly Region Size" help="Minimum size of an assembly region. Parameters that control active regions"/>
      <param name="min_base_quality_score" argument="--min-base-quality-score" type="integer" optional="true" value="10" label="Min Base Quality Score" help="Minimum base quality required to consider a base for calling. Bases with a quality below this threshold will not be used for calling."/>
      <param name="mitochondria_mode" argument="--mitochondria-mode" type="boolean" truevalue="--mitochondria-mode" falsevalue="" optional="true" checked="false" label="Mitochondria Mode" help="Mitochondria mode sets emission and initial LODs to 0. Mitochondria mode changes default values for --tumor-lod-to-emit and --initial-tumor-lod to 0 to increase sensitivity.&#10; --tumor-sample is also not explicitly required in mitochondria mode since a single sample bam is expected as input.&#10; Mitochondria mode is also required in FilterMutectCalls if used here."/>
      <param name="native_pair_hmm_threads" argument="--native-pair-hmm-threads" type="integer" optional="true" value="4" label="Native Pair Hmm Threads" help="How many threads should a native pairHMM implementation use. "/>
      <param name="native_pair_hmm_use_double_precision" argument="--native-pair-hmm-use-double-precision" type="boolean" truevalue="--native-pair-hmm-use-double-precision" falsevalue="" optional="true" checked="false" label="Native Pair Hmm Use Double Precision" help="use double precision in the native pairHmm. This is slower but matches the java implementation better. "/>
      <param name="normal_lod" argument="--normal-lod" type="float" optional="true" value="2.2" label="Normal Lod" help="Log 10 odds threshold for calling normal variant non-germline. This is a measure of the minimum evidence to support that a variant observed in the tumor is not also present in the normal.&#10; Applies to normal data in a tumor with matched normal analysis. The default has been tuned for diploid somatic analyses.&#10; It is unlikely such analyses will require changing the default value. Increasing the parameter may increase the sensitivity of somatic calling,&#10; but may also increase calling false positive, i.e. germline, variants."/>
      <repeat name="normal_sample_rpt" default="1" title="Normal Sample">
        <param name="normal_sample" argument="--normal-sample" type="text" optional="true" value="" label="Normal Sample" help="BAM sample name of normal(s), if any.  May be URL-encoded as output by GetSampleName with -encode argument. "/>
      </repeat>
      <param name="panel_of_normals" argument="--panel-of-normals" type="data" optional="true" format="vcf,vcf_bgzip" label="Panel Of Normals" help="VCF file of sites observed in normal. A panel of normals can be a useful (optional) input to help filter out commonly seen sequencing noise that may appear as low allele-fraction somatic variants."/>
      <param name="pcr_indel_qual" argument="--pcr-indel-qual" type="integer" optional="true" value="40" label="Pcr Indel Qual" help="Phred-scaled PCR SNV qual for overlapping fragments. "/>
      <param name="pcr_snv_qual" argument="--pcr-snv-qual" type="integer" optional="true" value="40" label="Pcr Snv Qual" help="Phred-scaled PCR SNV qual for overlapping fragments. "/>
      <param name="pedigree" argument="--pedigree" type="data" optional="true" format="tabular,tsv" label="Pedigree" help="Pedigree file for determining the population &amp;quot;founders&amp;quot;. "/>
      <param name="sites_only_vcf_output" argument="--sites-only-vcf-output" type="boolean" truevalue="--sites-only-vcf-output" falsevalue="" optional="true" checked="false" label="Sites Only Vcf Output" help="If true, don&amp;apos;t emit genotype fields when writing vcf file output. "/>
      <param name="tumor_lod_to_emit" argument="--tumor-lod-to-emit" type="float" optional="true" value="3.0" label="Tumor Lod To Emit" help="Log 10 odds threshold to emit variant to VCF. Only variants with tumor LODs exceeding this threshold will be written to the VCF, regardless of filter status.&#10; Set to less than or equal to tumor_lod. Increase argument value to reduce false positives in the callset.&#10; Default setting of 3 is permissive and will emit some amount of negative training data that &#10; {@link FilterMutectCalls} should then filter."/>
    </section>
    <section name="advanced" title="Advanced Parameters" expanded="False">
      <param name="active_probability_threshold" argument="--active-probability-threshold" type="float" optional="true" value="0.002" label="Active Probability Threshold" help="Minimum probability for a locus to be considered active. "/>
      <param name="adaptive_pruning_initial_error_rate" argument="--adaptive-pruning-initial-error-rate" type="float" optional="true" value="0.001" label="Adaptive Pruning Initial Error Rate" help="Initial base error rate estimate for adaptive pruning. Initial base error rate guess for the probabilistic adaptive pruning model.  Results are not very sensitive to this&#10; parameter because it is only a starting point from which the algorithm discovers the true error rate."/>
      <param name="allele_informative_reads_overlap_margin" argument="--allele-informative-reads-overlap-margin" type="integer" optional="true" value="2" label="Allele Informative Reads Overlap Margin" help="Likelihood and read-based annotations will only take into consideration reads that overlap the variant or any base no further than this distance expressed in base pairs. "/>
      <param name="allow_non_unique_kmers_in_ref" argument="--allow-non-unique-kmers-in-ref" type="boolean" truevalue="--allow-non-unique-kmers-in-ref" falsevalue="" optional="true" checked="false" label="Allow Non Unique Kmers In Ref" help="Allow graphs that have non-unique kmers in the reference. By default, the program does not allow processing of reference sections that contain non-unique kmers. Disabling&#10; this check may cause problems in the assembly graph."/>
      <param name="bam_writer_type" argument="--bam-writer-type" type="select" optional="true" label="Bam Writer Type" help="Which haplotypes should be written to the BAM. The type of BAM output we want to see. This determines whether HC will write out all of the haplotypes it&#10; considered (top 128 max) or just the ones that were selected as alleles and assigned to samples.">
        <option value="ALL_POSSIBLE_HAPLOTYPES">ALL_POSSIBLE_HAPLOTYPES</option>
        <option selected="true" value="CALLED_HAPLOTYPES">CALLED_HAPLOTYPES</option>
      </param>
      <param name="disable_adaptive_pruning" argument="--disable-adaptive-pruning" type="boolean" truevalue="--disable-adaptive-pruning" falsevalue="" optional="true" checked="false" label="Disable Adaptive Pruning" help="Disable the adaptive algorithm for pruning paths in the graph. A single edge multiplicity cutoff for pruning doesn&amp;apos;t work in samples with variable depths, for example exomes&#10; and RNA.  This parameter disables the probabilistic algorithm for pruning the assembly graph that considers the&#10; likelihood that each chain in the graph comes from real variation, and instead uses a simple multiplicity cutoff."/>
      <param name="disable_tool_default_annotations" argument="--disable-tool-default-annotations" type="boolean" truevalue="--disable-tool-default-annotations" falsevalue="" optional="true" checked="false" label="Disable Tool Default Annotations" help="Disable all tool default annotations. Hook allowing for the user to remove default annotations from the tool"/>
      <param name="dont_increase_kmer_sizes_for_cycles" argument="--dont-increase-kmer-sizes-for-cycles" type="boolean" truevalue="--dont-increase-kmer-sizes-for-cycles" falsevalue="" optional="true" checked="false" label="Dont Increase Kmer Sizes For Cycles" help="Disable iterating over kmer sizes when graph cycles are detected. When graph cycles are detected, the normal behavior is to increase kmer sizes iteratively until the cycles are&#10; resolved. Disabling this behavior may cause the program to give up on assembling the ActiveRegion."/>
      <param name="dont_use_soft_clipped_bases" argument="--dont-use-soft-clipped-bases" type="boolean" truevalue="--dont-use-soft-clipped-bases" falsevalue="" optional="true" checked="false" label="Dont Use Soft Clipped Bases" help="Do not analyze soft clipped bases in the reads. "/>
      <param name="emit_ref_confidence" argument="--emit-ref-confidence" type="select" optional="true" label="Emit Ref Confidence" help="Mode for emitting reference confidence scores (For Mutect2, this is a BETA feature). The reference confidence mode makes it possible to emit a per-bp or summarized confidence estimate for a site being strictly homozygous-reference.&#10; See https://software.broadinstitute.org/gatk/documentation/article.php?id=4017 for information about GVCFs.&#10; For Mutect2, this is a BETA feature that functions similarly to the HaplotypeCaller reference confidence/GVCF mode.">
        <option selected="true" value="NONE">NONE</option>
        <option value="BP_RESOLUTION">BP_RESOLUTION</option>
        <option value="GVCF">GVCF</option>
      </param>
      <param name="enable_all_annotations" argument="--enable-all-annotations" type="boolean" truevalue="--enable-all-annotations" falsevalue="" optional="true" checked="false" label="Enable All Annotations" help="Use all possible annotations (not for the faint of heart). You can use the -AX argument in combination with this one to exclude specific annotations. Note that some&#10; annotations may not be actually applied if they are not applicable to the data provided or if they are&#10; unavailable to the tool (e.g. there are several annotations that are currently not hooked up to&#10; HaplotypeCaller). At present no error or warning message will be provided, the annotation will simply be&#10; skipped silently. You can check the output VCF header to see which annotations were activated and thus might be applied (although&#10; this does not guarantee that the annotation was applied to all records in the VCF, since some annotations have&#10; additional requirements, e.g. minimum number of samples or heterozygous sites only -- see the documentation&#10; for individual annotations&amp;apos; requirements)."/>
      <param name="force_active" argument="--force-active" type="boolean" truevalue="--force-active" falsevalue="" optional="true" checked="false" label="Force Active" help="If provided, all regions will be marked as active. "/>
      <param name="force_call_filtered_alleles" argument="--force-call-filtered-alleles" type="boolean" truevalue="--force-call-filtered-alleles" falsevalue="" optional="true" checked="false" label="Force Call Filtered Alleles" help="Force-call filtered alleles included in the resource specified by --alleles. "/>
      <repeat name="gvcf_lod_band_rpt" default="1" title="Gvcf Lod Band">
        <param name="gvcf_lod_band" argument="--gvcf-lod-band" type="text" optional="true" value="" label="Gvcf Lod Band" help="Exclusive upper bounds for reference confidence LOD bands (must be specified in increasing order). When Mutect2 is run in reference confidence mode with banding compression enabled (-ERC GVCF), homozygous-reference&#10; sites are compressed into bands of similar tumor LOD (TLOD) that are emitted as a single VCF record. See&#10; the FAQ documentation for more details about the GVCF format.&#10; &amp;lt;p&amp;gt;&#10; This argument allows you to set the TLOD bands. Mutect2 expects a list of strictly increasing TLOD values&#10; that will act as exclusive upper bounds for the TLOD bands. To pass multiple values,&#10; you provide them one by one with the argument, as in `-LODB -3.0 -LODB -2.0 -LODB -1.0`&#10; (this would set the TLOD bands to be `[-Inf, -3.0), [-3.0, -2.0), [-2.0, -1.0), [-1.0, Inf]`, for example).&#10; &amp;lt;p&amp;gt;&#10; Note that, unlike the GQ used by HaplotypeCaller GVCFs, here the reference calls with the highest confidence are the most negative."/>
      </repeat>
      <param name="independent_mates" argument="--independent-mates" type="boolean" truevalue="--independent-mates" falsevalue="" optional="true" checked="false" label="Independent Mates" help="Allow paired reads to independently support different haplotypes.  Useful for validations with ill-designed synthetic data. "/>
      <param name="kmer_size" argument="--kmer-size" type="integer" optional="true" value="" label="Kmer Size" help="Kmer size to use in the read threading assembler. Multiple kmer sizes can be specified, using e.g. `--kmer-size 10 --kmer-size 25`."/>
      <param name="max_mnp_distance" argument="--max-mnp-distance" type="integer" optional="true" value="1" label="Max Mnp Distance" help="Two or more phased substitutions separated by this distance or less are merged into MNPs. Two or more phased substitutions separated by this distance or less are merged into MNPs."/>
      <param name="max_num_haplotypes_in_population" argument="--max-num-haplotypes-in-population" type="integer" optional="true" value="128" label="Max Num Haplotypes In Population" help="Maximum number of haplotypes to consider for your population. The assembly graph can be quite complex, and could imply a very large number of possible haplotypes.  Each haplotype&#10; considered requires N PairHMM evaluations if there are N reads across all samples.  In order to control the&#10; run of the haplotype caller we only take maxNumHaplotypesInPopulation paths from the graph, in order of their&#10; weights, no matter how many paths are possible to generate from the graph.  Putting this number too low&#10; will result in dropping true variation because paths that include the real variant are not even considered.&#10; You can consider increasing this number when calling organisms with high heterozygosity."/>
      <param name="max_prob_propagation_distance" argument="--max-prob-propagation-distance" type="integer" optional="true" value="50" label="Max Prob Propagation Distance" help="Upper limit on how many bases away probability mass can be moved around when calculating the boundaries between active and inactive assembly regions. "/>
      <param name="max_suspicious_reads_per_alignment_start" argument="--max-suspicious-reads-per-alignment-start" type="integer" optional="true" value="0" label="Max Suspicious Reads Per Alignment Start" help="Maximum number of suspicious reads (mediocre mapping quality or too many substitutions) allowed in a downsampling stride.  Set to 0 to disable. Maximum number of suspicious reads (mediocre mapping quality or too many substitutions) allowed in a downsampling stride."/>
      <param name="max_unpruned_variants" argument="--max-unpruned-variants" type="integer" optional="true" value="100" label="Max Unpruned Variants" help="Maximum number of variants in graph the adaptive pruner will allow. The maximum number of variants in graph the adaptive pruner will allow"/>
      <param name="min_dangling_branch_length" argument="--min-dangling-branch-length" type="integer" optional="true" value="4" label="Min Dangling Branch Length" help="Minimum length of a dangling branch to attempt recovery. When constructing the assembly graph we are often left with &amp;quot;dangling&amp;quot; branches.  The assembly engine attempts to rescue these branches&#10; by merging them back into the main graph.  This argument describes the minimum length of a dangling branch needed for the engine to&#10; try to rescue it.  A smaller number here will lead to higher sensitivity to real variation but also to a higher number of false positives."/>
      <param name="min_pruning" argument="--min-pruning" type="integer" optional="true" value="2" label="Min Pruning" help="Minimum support to not prune paths in the graph. Paths with fewer supporting kmers than the specified threshold will be pruned from the graph.&#10;&#10; Be aware that this argument can dramatically affect the results of variant calling and should only be used with great caution.&#10; Using a prune factor of 1 (or below) will prevent any pruning from the graph, which is generally not ideal; it can make the&#10; calling much slower and even less accurate (because it can prevent effective merging of &amp;quot;tails&amp;quot; in the graph).  Higher values&#10; tend to make the calling much faster, but also lowers the sensitivity of the results (because it ultimately requires higher&#10; depth to produce calls)."/>
      <param name="minimum_allele_fraction" argument="--minimum-allele-fraction" type="float" optional="true" value="0.0" label="Minimum Allele Fraction" help="Lower bound of variant allele fractions to consider when calculating variant LOD. "/>
      <param name="num_pruning_samples" argument="--num-pruning-samples" type="integer" optional="true" value="1" label="Num Pruning Samples" help="Number of samples that must pass the minPruning threshold. If fewer samples than the specified number pass the minPruning threshold for a given path, that path will be eliminated from the graph."/>
      <param name="pair_hmm_gap_continuation_penalty" argument="--pair-hmm-gap-continuation-penalty" type="integer" optional="true" value="10" label="Pair Hmm Gap Continuation Penalty" help="Flat gap continuation penalty for use in the Pair HMM. "/>
      <param name="pair_hmm_implementation" argument="--pair-hmm-implementation" type="select" optional="true" label="Pair Hmm Implementation" help="The PairHMM implementation to use for genotype likelihood calculations. The PairHMM implementation to use for genotype likelihood calculations. The various implementations balance a tradeoff of accuracy and runtime.">
        <option value="EXACT">EXACT</option>
        <option value="ORIGINAL">ORIGINAL</option>
        <option value="LOGLESS_CACHING">LOGLESS_CACHING</option>
        <option value="AVX_LOGLESS_CACHING">AVX_LOGLESS_CACHING</option>
        <option value="AVX_LOGLESS_CACHING_OMP">AVX_LOGLESS_CACHING_OMP</option>
        <option value="EXPERIMENTAL_FPGA_LOGLESS_CACHING">EXPERIMENTAL_FPGA_LOGLESS_CACHING</option>
        <option selected="true" value="FASTEST_AVAILABLE">FASTEST_AVAILABLE</option>
      </param>
      <param name="pcr_indel_model" argument="--pcr-indel-model" type="select" optional="true" label="Pcr Indel Model" help="The PCR indel model to use. When calculating the likelihood of variants, we can try to correct for PCR errors that cause indel artifacts.&#10; The correction is based on the reference context, and acts specifically around repetitive sequences that tend&#10; to cause PCR errors). The variant likelihoods are penalized in increasing scale as the context around a&#10; putative indel is more repetitive (e.g. long homopolymer). The correction can be disabling by specifying&#10; &amp;apos;-pcrModel NONE&amp;apos;; in that case the default base insertion/deletion qualities will be used (or taken from the&#10; read if generated through the BaseRecalibrator). &amp;lt;b&amp;gt;VERY IMPORTANT: when using PCR-free sequencing data we&#10; definitely recommend setting this argument to NONE&amp;lt;/b&amp;gt;.">
        <option value="NONE">NONE</option>
        <option value="HOSTILE">HOSTILE</option>
        <option value="AGGRESSIVE">AGGRESSIVE</option>
        <option selected="true" value="CONSERVATIVE">CONSERVATIVE</option>
      </param>
      <param name="phred_scaled_global_read_mismapping_rate" argument="--phred-scaled-global-read-mismapping-rate" type="integer" optional="true" value="45" label="Phred Scaled Global Read Mismapping Rate" help="The global assumed mismapping rate for reads. The phredScaledGlobalReadMismappingRate reflects the average global mismapping rate of all reads, regardless of their&#10; mapping quality.  This term effects the probability that a read originated from the reference haplotype, regardless of&#10; its edit distance from the reference, in that the read could have originated from the reference haplotype but&#10; from another location in the genome.  Suppose a read has many mismatches from the reference, say like 5, but&#10; has a very high mapping quality of 60.  Without this parameter, the read would contribute 5 * Q30 evidence&#10; in favor of its 5 mismatch haplotype compared to reference, potentially enough to make a call off that single&#10; read for all of these events.  With this parameter set to Q30, though, the maximum evidence against any haplotype&#10; that this (and any) read could contribute is Q30.&#10;&#10; Set this term to any negative number to turn off the global mapping rate."/>
      <param name="pruning_lod_threshold" argument="--pruning-lod-threshold" type="float" optional="true" value="2.302585092994046" label="Pruning Lod Threshold" help="Ln likelihood ratio threshold for adaptive pruning algorithm. Log-10 likelihood ratio threshold for adaptive pruning algorithm."/>
      <param name="recover_all_dangling_branches" argument="--recover-all-dangling-branches" type="boolean" truevalue="--recover-all-dangling-branches" falsevalue="" optional="true" checked="false" label="Recover All Dangling Branches" help="Recover all dangling branches. By default, the read threading assembler does not recover dangling branches that fork after splitting from the reference.  This argument&#10; tells the assembly engine to recover all dangling branches."/>
      <param name="smith_waterman" argument="--smith-waterman" type="select" optional="true" label="Smith Waterman" help="Which Smith-Waterman implementation to use, generally FASTEST_AVAILABLE is the right choice. ">
        <option value="FASTEST_AVAILABLE">FASTEST_AVAILABLE</option>
        <option value="AVX_ENABLED">AVX_ENABLED</option>
        <option selected="true" value="JAVA">JAVA</option>
      </param>
    </section>
    <section name="common" title="Common Parameters" expanded="False">
      <expand macro="gatk_excl_ints"/>
      <expand macro="seq_dict_sel"/>
      <param name="add_output_sam_program_record" argument="--add-output-sam-program-record" type="boolean" truevalue="--add-output-sam-program-record" falsevalue="" optional="true" checked="true" label="Add Output Sam Program Record" help="If true, adds a PG tag to created SAM/BAM/CRAM files. "/>
      <param name="add_output_vcf_command_line" argument="--add-output-vcf-command-line" type="boolean" truevalue="--add-output-vcf-command-line" falsevalue="" optional="true" checked="true" label="Add Output Vcf Command Line" help="If true, adds a command line header line to created VCF files. "/>
      <repeat name="disable_read_filter_rpt" default="1" title="Disable Read Filter">
        <param name="disable_read_filter" argument="--disable-read-filter" type="text" optional="true" value="" label="Disable Read Filter" help="Read filters to be disabled before analysis. "/>
      </repeat>
      <param name="disable_tool_default_read_filters" argument="--disable-tool-default-read-filters" type="boolean" truevalue="--disable-tool-default-read-filters" falsevalue="" optional="true" checked="false" label="Disable Tool Default Read Filters" help="Disable all tool default read filters (WARNING: many tools will not function correctly without their default read filters on). "/>
      <param name="gatk_config_file" argument="--gatk-config-file" type="data" optional="true" format="txt" label="Gatk Config File" help="A configuration file to use with the GATK. "/>
      <param name="interval_set_rule" argument="--interval-set-rule" type="select" optional="true" label="Interval Set Rule" help="Set merging approach to use for combining interval inputs. By default, the program will take the UNION of all intervals specified using -L and/or -XL. However, you can&#10; change this setting for -L, for example if you want to take the INTERSECTION of the sets instead. E.g. to&#10; perform the analysis only on chromosome 1 exomes, you could specify -L exomes.intervals -L 1 --interval-set-rule&#10; INTERSECTION. However, it is not possible to modify the merging approach for intervals passed using -XL (they will&#10; always be merged using UNION).&#10;&#10; Note that if you specify both -L and -XL, the -XL interval set will be subtracted from the -L interval set.">
        <option selected="true" value="UNION">UNION</option>
        <option value="INTERSECTION">INTERSECTION</option>
      </param>
      <param name="lenient" argument="--lenient" type="boolean" truevalue="--lenient" falsevalue="" optional="true" checked="false" label="Lenient" help="Lenient processing of VCF files. "/>
      <param name="QUIET" argument="--QUIET" type="boolean" truevalue="--QUIET" falsevalue="" optional="true" checked="false" label="Quiet" help="Whether to suppress job-summary info on System.err. "/>
      <repeat name="read_filter_rpt" default="1" title="Read Filter">
        <param name="read_filter" argument="--read-filter" type="text" optional="true" value="" label="Read Filter" help="Read filters to be applied before analysis. "/>
      </repeat>
      <param name="read_validation_stringency" argument="--read-validation-stringency" type="select" optional="true" label="Read Validation Stringency" help="Validation stringency for all SAM/BAM/CRAM/SRA files read by this program.  The default stringency value SILENT can improve performance when processing a BAM file in which variable-length data (read, qualities, tags) do not otherwise need to be decoded. ">
        <option value="STRICT">STRICT</option>
        <option value="LENIENT">LENIENT</option>
        <option selected="true" value="SILENT">SILENT</option>
      </param>
      <param name="seconds_between_progress_updates" argument="--seconds-between-progress-updates" type="float" optional="true" value="10.0" label="Seconds Between Progress Updates" help="Output traversal statistics every time this many seconds elapse. "/>
      <param name="tmp_dir" argument="--tmp-dir" type="text" optional="true" value="" label="Tmp Dir" help="Temp directory to use. "/>
      <param name="use_jdk_deflater" argument="--use-jdk-deflater" type="boolean" truevalue="--use-jdk-deflater" falsevalue="" optional="true" checked="false" label="Use Jdk Deflater" help="Whether to use the JdkDeflater (as opposed to IntelDeflater). "/>
      <param name="use_jdk_inflater" argument="--use-jdk-inflater" type="boolean" truevalue="--use-jdk-inflater" falsevalue="" optional="true" checked="false" label="Use Jdk Inflater" help="Whether to use the JdkInflater (as opposed to IntelInflater). "/>
      <param name="verbosity" argument="--verbosity" type="select" optional="true" label="Verbosity" help="Control verbosity of logging. ">
        <option value="ERROR">ERROR</option>
        <option value="WARNING">WARNING</option>
        <option selected="true" value="INFO">INFO</option>
        <option value="DEBUG">DEBUG</option>
      </param>
    </section>
    <section name="deprecated" title="Deprecated Parameters" expanded="False">
      <param name="tumor_sample" argument="--tumor-sample" type="text" optional="true" value="" label="Tumor Sample" help="BAM sample name of tumor.  May be URL-encoded as output by GetSampleName with -encode argument. "/>
    </section>
    <section name="output_opt" title="Additional Output Parameters" expanded="False">
      <param name="assembly_region_out_sel" argument="--assembly_region_out_sel" type="boolean" truevalue="--assembly_region_out_sel" falsevalue="" optional="true" checked="false" label="Assembly Region Out" help="Output the assembly region to this IGV formatted file. If provided, this walker will write out its assembly regions&#10; to this file in the IGV formatted TAB-delimited output:&#10;&#10; http://www.broadinstitute.org/software/igv/IGV&#10;&#10; Intended to make debugging the active region calculations easier"/>
      <param name="bam_output_sel" argument="--bam_output_sel" type="boolean" truevalue="--bam_output_sel" falsevalue="" optional="true" checked="false" label="Bam Output" help="File to which assembled haplotypes should be written. The assembled haplotypes and locally realigned reads will be written as BAM to this file if requested.  Really&#10; for debugging purposes only. Note that the output here does not include uninformative reads so that not every&#10; input read is emitted to the bam.&#10;&#10; Turning on this mode may result in serious performance cost for the caller.  It&amp;apos;s really only appropriate to&#10; use in specific areas where you want to better understand why the caller is making specific calls.&#10;&#10; The reads are written out containing an &amp;quot;HC&amp;quot; tag (integer) that encodes which haplotype each read best matches&#10; according to the haplotype caller&amp;apos;s likelihood calculation.  The use of this tag is primarily intended&#10; to allow good coloring of reads in IGV.  Simply go to &amp;quot;Color Alignments By &amp;gt; Tag&amp;quot; and enter &amp;quot;HC&amp;quot; to more&#10; easily see which reads go with these haplotype.&#10;&#10; Note that the haplotypes (called or all, depending on mode) are emitted as single reads covering the entire&#10; active region, coming from sample &amp;quot;HC&amp;quot; and a special read group called &amp;quot;ArtificialHaplotype&amp;quot;. This will increase the&#10; pileup depth compared to what would be expected from the reads only, especially in complex regions.&#10;&#10; Note also that only reads that are actually informative about the haplotypes are emitted.  By informative we mean&#10; that there&amp;apos;s a meaningful difference in the likelihood of the read coming from one haplotype compared to&#10; its next best haplotype.&#10;&#10; If multiple BAMs are passed as input to the tool (as is common for M2), then they will be combined in the bamout&#10; output and tagged with the appropriate sample names.&#10;&#10; The best way to visualize the output of this mode is with IGV.  Tell IGV to color the alignments by tag,&#10; and give it the &amp;quot;HC&amp;quot; tag, so you can see which reads support each haplotype.  Finally, you can tell IGV&#10; to group by sample, which will separate the potential haplotypes from the reads.  All of this can be seen in&#10; &amp;lt;a href=&amp;quot;https://www.dropbox.com/s/xvy7sbxpf13x5bp/haplotypecaller%20bamout%20for%20docs.png&amp;quot;&amp;gt;this screenshot&amp;lt;/a&amp;gt;"/>
      <param name="debug_assembly_sel" argument="--debug_assembly_sel" type="boolean" truevalue="--debug_assembly_sel" falsevalue="" optional="true" checked="false" label="Debug Assembly" help="Print out verbose debug information about each assembly region. "/>
      <param name="f1r2_tar_gz_sel" argument="--f1r2_tar_gz_sel" type="boolean" truevalue="--f1r2_tar_gz_sel" falsevalue="" optional="true" checked="false" label="F1R2 Tar Gz" help="If specified, collect F1R2 counts and output files into this tar.gz file. "/>
      <param name="graph_output_sel" argument="--graph_output_sel" type="boolean" truevalue="--graph_output_sel" falsevalue="" optional="true" checked="false" label="Graph Output" help="Write debug assembly graph information to this file. This argument is meant for debugging and is not immediately useful for normal analysis use."/>
    </section>
  </inputs>
  <outputs>
    <expand macro="mutect_stats"/>
    <data format="tabular" name="assembly_region_out" label="${tool.name} on ${on_string}: assembly_region_out tabular">
      <filter>output_opt['assembly_region_out_sel']</filter>
    </data>
    <data format="bam" name="bam_output" label="${tool.name} on ${on_string}: bam_output bam">
      <filter>output_opt['bam_output_sel']</filter>
    </data>
    <data format="txt" name="debug_assembly" label="${tool.name} on ${on_string}: debug_assembly txt">
      <filter>output_opt['debug_assembly_sel']</filter>
    </data>
    <data format="txt" name="f1r2_tar_gz" label="${tool.name} on ${on_string}: f1r2_tar_gz txt" from_work_dir="f1r2_tar_gz.tar.gz">
      <filter>output_opt['f1r2_tar_gz_sel']</filter>
    </data>
    <data format="txt" name="graph_output" label="${tool.name} on ${on_string}: graph_output txt">
      <filter>output_opt['graph_output_sel']</filter>
    </data>
  </outputs>
  <tests/>
  <help><![CDATA[Call somatic short mutations via local assembly of haplotypes. Short
mutations include single nucleotide (SNA) and insertion and deletion
(indel) alterations. The caller uses a Bayesian somatic genotyping model
that differs from the original MuTect by `Cibulskis et al.,
2013 <http://www.nature.com/nbt/journal/v31/n3/full/nbt.2514.html>`__
and uses the assembly-based machinery of
`HaplotypeCaller <https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_walkers_haplotypecaller_HaplotypeCaller.php>`__.
Of note, Mutect2 v4.1.0.0 onwards enables joint analysis of multiple
samples.

This tool is featured in the *Somatic Short Mutation calling Best
Practice Workflow*. See
`Tutorial#11136 <https://software.broadinstitute.org/gatk/documentation/article?id=11136>`__
for a step-by-step description of the workflow and
`Article#11127 <https://software.broadinstitute.org/gatk/documentation/article?id=11127>`__
for an overview of what traditional somatic calling entails. For the
latest pipeline scripts, see the `Mutect2 WDL scripts
directory <https://github.com/broadinstitute/gatk/tree/master/scripts/mutect2_wdl>`__.
For pipelines with example data, see the `gatk-workflows
repository <https://github.com/gatk-workflows/gatk4-somatic-snvs-indels>`__.
Although we present the tool for somatic calling, it may apply to other
contexts, such as mitochondrial variant calling and detection of somatic
mosaicism.

Starting with v4.1.0.0 Mutect2 accomodates extreme high depths, e.g.
20,000X. See the following articles for details on this and additional
applications.

-  `Blog#23400 <https://software.broadinstitute.org/gatk/blog?id=23400>`__
   details general improvements to Mutect2 v4.1.0.0.
-  `Blog#23598 <https://software.broadinstitute.org/gatk/blog?id=23598>`__
   details Mutect2 mitochondrial mode.
-  `Blog#XXX <https://software.broadinstitute.org/gatk/blog?id=XXX>`__
   (link to come) details use of Mutect2 in extremely low allele
   fraction variant detection.

Usage examples
~~~~~~~~~~~~~~

Example commands show how to run Mutect2 for typical scenarios. The
three modes are (i) tumor-normal mode where a tumor sample is matched
with a normal sample in analysis, (ii) tumor-only mode where a single
sample's alignment data undergoes analysis, and (iii) mitochondrial mode
where sensitive calling at high depths is desirable.

-  As of v4.1, there is no longer a need to specify the tumor sample
   name with -tumor. You need only specify the normal sample name with
   -normal, if you include a normal.
-  Starting with v4.0.4.0, GATK recommends the default setting of
   --af-of-alleles-not-in-resource, which the tool dynamically adjusts
   for different modes. tumor-only calling sets the default to 5e-8,
   tumor-normal calling sets it to 1e-6 and mitochondrial mode sets it
   to 4e-3. For previous versions, the default was 0.001, the average
   heterozygosity of humans. For other organisms, change
   --af-of-alleles-not-in-resource to 1/(ploidy*samples in resource).

(i) Tumor with matched normal
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Given a matched normal, Mutect2 is designed to call somatic variants
only. The tool includes logic to skip emitting variants that are clearly
present in the germline based on provided evidence, e.g. in the matched
normal. This is done at an early stage to avoid spending computational
resources on germline events. If the variant's germline status is
borderline, then Mutect2 will emit the variant to the callset for
subsequent filtering by
`FilterMutectCalls <https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_walkers_mutect_FilterMutectCalls.php>`__
and review.

::

        gatk Mutect2 \
        -R reference.fa \
        -I tumor.bam \
        -I normal.bam \
        -normal normal_sample_name \
        --germline-resource af-only-gnomad.vcf.gz \
        --panel-of-normals pon.vcf.gz \
        -O somatic.vcf.gz
    

Mutect2 also generates a stats file names [output vcf].stats. That is,
in the above example the stats file would be named somatic.vcf.gz.stats
and would be in the same folder as somatic.vcf.gz. As of GATK 4.1.1 this
file is a required input to FilterMutectCalls.

As of v4.1 Mutect2 supports joint calling of multiple tumor and normal
samples from the same individual. The only difference is that -I and
-normal must be specified for the extra samples.

::

        gatk Mutect2 \
        -R reference.fa \
        -I tumor1.bam \
        -I tumor2.bam \
        -I normal1.bam \
        -I normal2.bam \
        -normal normal1_sample_name \
        -normal normal2_sample_name \
        --germline-resource af-only-gnomad.vcf.gz \
        --panel-of-normals pon.vcf.gz \
        -O somatic.vcf.gz
    

(ii) Tumor-only mode
^^^^^^^^^^^^^^^^^^^^

This mode runs on a single type of sample, e.g. the tumor or the normal.
To create a PoN, call on each normal sample in this mode, then use
`CreateSomaticPanelOfNormals <https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_walkers_mutect_CreateSomaticPanelOfNormals.php>`__
to generate the PoN.

::

     gatk Mutect2 \
      -R reference.fa \
      -I sample.bam \
      -O single_sample.vcf.gz
    

To call mutations on a tumor sample, call in this mode using a PoN and
germline resource. After FilterMutectCalls filtering, consider
additional filtering by functional significance with
`Funcotator <https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_funcotator_Funcotator.php>`__.

::

     gatk Mutect2 \
     -R reference.fa \
     -I sample.bam \
     --germline-resource af-only-gnomad.vcf.gz \
     --panel-of-normals pon.vcf.gz \
     -O single_sample.vcf.gz
    

(iii) Mitochondrial mode
^^^^^^^^^^^^^^^^^^^^^^^^

Mutect2 automatically sets parameters appropriately for calling on
mitochondria with the --mitochondria flag. Specifically, the mode sets
--initial-tumor-lod to 0, --tumor-lod-to-emit to 0,
--af-of-alleles-not-in-resource to 4e-3, and the advanced parameter
--pruning-lod-threshold to -4.

::

     gatk Mutect2 \
     -R reference.fa \
     -L chrM \
     --mitochondria-mode \
     -I mitochondria.bam \
     -O mitochondria.vcf.gz
    

The mode accepts only a single sample, which can be provided in multiple
files.

(iv) Force-calling mode
^^^^^^^^^^^^^^^^^^^^^^^

This mode force-calls all alleles in force-call-alleles.vcf in addition
to any other variants Mutect2 discovers.

::

     gatk Mutect2 \
      -R reference.fa \
      -I sample.bam \
      -alleles force-call-alleles.vcf
      -O single_sample.vcf.gz
    

If the sample is suspected to exhibit orientation bias artifacts (such
as in the case of FFPE tumor samples) one should also collect F1R2
metrics by adding an --f1r2-tar-gz argument as shown below. This file
contains information that can then be passed to
LearnReadOrientationModel, which generate an artifact prior table for
each tumor sample for FilterMutectCalls to use.

::

    gatk Mutect2 \
     -R reference.fa \
     -I sample.bam \
     --f1r2-tar-gz f1r2.tar.gz \
     -O single_sample.vcf.gz
     

Notes
~~~~~

#. Mutect2 does not require a germline resource nor a panel of normals
   (PoN) to run, although both are recommended. The tool prefilters
   sites for the matched normal and the PoN.

#. If a variant is absent from a given germline resource, then the value
   for --af-of-alleles-not-in-resource is used as an imputed allele
   frequency. Below is an excerpt of a known variants resource with
   population allele frequencies.

   ::

           #CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO
            1       10067   .       T       TAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCC      30.35   PASS    AC=3;AF=7.384E-5
            1       10108   .       CAACCCT C       46514.32        PASS    AC=6;AF=1.525E-4
            1       10109   .       AACCCTAACCCT    AAACCCT,*       89837.27        PASS    AC=48,5;AF=0.001223,1.273E-4
            1       10114   .       TAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAACCCTAACCCTAACCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAAACCCTA  *,CAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAACCCTAACCCTAACCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAAACCCTA,T      36728.97        PASS    AC=55,9,1;AF=0.001373,2.246E-4,2.496E-5
            1       10119   .       CT      C,*     251.23  PASS    AC=5,1;AF=1.249E-4,2.498E-5
            1       10120   .       TA      CA,*    14928.74        PASS    AC=10,6;AF=2.5E-4,1.5E-4
            1       10128   .       ACCCTAACCCTAACCCTAAC    A,*     285.71  PASS    AC=3,1;AF=7.58E-5,2.527E-5
            1       10131   .       CT      C,*     378.93  PASS    AC=7,5;AF=1.765E-4,1.261E-4
            1       10132   .       TAACCC  *,T     18025.11        PASS    AC=12,2;AF=3.03E-4,5.049E-5
           

#. Additional parameters that factor towards filtering are available in
   `FilterMutectCalls <https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_walkers_mutect_FilterMutectCalls.php>`__.
   While the tool calculates normal-lod assuming a diploid genotype, it
   calculates normal-artifact-lod with the same approach it uses for
   tumor-lod, i.e. with a variable ploidy assumption.

   -  If the normal artifact log odds becomes large, then
      FilterMutectCalls applies the artifact-in-normal filter..
   -  The tumor log odds, which is calculated independently of any
      matched normal, determines whether to filter a tumor variant.
      Variants with tumor LODs exceeding the threshold pass filtering.
]]></help>
  <citations>
    <expand macro="citations"/>
  </citations>
</tool>
